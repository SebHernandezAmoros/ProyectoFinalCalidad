¢&
XD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Controllers\AuthController.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Controllers. 9
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public 
AuthController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Login "
(" #
string# )
Username* 2
,2 3
string4 :
Password; C
)C D
{ 	
if 
( 

dbEntities 
. 
	Empleados #
.# $
Any$ '
(' (
o( )
=>* ,
o- .
.. /
Usuario/ 6
==7 9
Username: B
&&C E
oF G
.G H
ClaveH M
==N P
PasswordQ Y
)Y Z
)Z [
{   
var!! 
claims!! 
=!! 
new!!  
List!!! %
<!!% &
Claim!!& +
>!!+ ,
(!!, -
)!!- .
{"" 
new## 
Claim## 
(## 

ClaimTypes## (
.##( )
Name##) -
,##- .
Username##/ 7
)##7 8
,##8 9
}$$ 
;$$ 
var%% 
claimsIdentity%% "
=%%# $
new%%% (
ClaimsIdentity%%) 7
(%%7 8
claims%%8 >
,%%> ?(
CookieAuthenticationDefaults%%@ \
.%%\ ] 
AuthenticationScheme%%] q
)%%q r
;%%r s
var&& 
claimsPrincipal&& #
=&&$ %
new&&& )
ClaimsPrincipal&&* 9
(&&9 :
claimsIdentity&&: H
)&&H I
;&&I J
HttpContext)) 
.)) 
SignInAsync)) '
())' (
claimsPrincipal))( 7
)))7 8
;))8 9
return00 
RedirectToAction00 '
(00' (
$str00( .
,00. /
$str000 6
)006 7
;007 8
}11 

ModelState33 
.33 
AddModelError33 $
(33$ %
$str33% 0
,330 1
$str332 U
)33U V
;33V W
if44 
(44 
!44 

ModelState44 
.44 
IsValid44 #
)44# $
{55 
return66 
View66 
(66 
$str66 #
)66# $
;66$ %
}77 
return99 
View99 
(99 
)99 
;99 
}:: 	
[<< 	
HttpGet<<	 
]<< 
public== 
IActionResult== 
Logout== #
(==# $
)==$ %
{>> 	
HttpContext?? 
.?? 
SignOutAsync?? $
(??$ %
)??% &
;??& '
return@@ 
RedirectToAction@@ #
(@@# $
$str@@$ +
)@@+ ,
;@@, -
}AA 	
[CC 	
HttpGetCC	 
]CC 
publicDD 
IActionResultDD 
InitDD !
(DD! "
)DD" #
{EE 	
ViewBagFF 
.FF 
perfilFF 
=FF 
GetLoggedUserFF *
(FF* +
)FF+ ,
;FF, -
returnHH 
ViewHH 
(HH 
)HH 
;HH 
}II 	
privateKK 
EmpleadoKK 
GetLoggedUserKK &
(KK& '
)KK' (
{LL 	
varMM 
claimMM 
=MM 
HttpContextMM #
.MM# $
UserMM$ (
.MM( )
ClaimsMM) /
.MM/ 0
FirstOrDefaultMM0 >
(MM> ?
)MM? @
;MM@ A
varNN 
usernameNN 
=NN 
claimNN  
.NN  !
ValueNN! &
;NN& '
returnOO 

dbEntitiesOO 
.OO 
	EmpleadosOO '
.OO' (
FirstOrDefaultOO( 6
(OO6 7
oOO7 8
=>OO9 ;
oOO< =
.OO= >
UsuarioOO> E
==OOF H
usernameOOI Q
)OOQ R
;OOR S
}PP 	
}QQ 
}RR ≈
XD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Controllers\HomeController.cs
	namespace

 	0
$TransportesYComercializaci√≥nTRANSMI


 -
.

- .
Controllers

. 9
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
public 
HomeController 
( 
) 
{ 	
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
	Servicios &
(& '
)' (
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Nosotros %
(% &
)& '
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Contactanos (
(( )
)) *
{ 	
return   
View   
(   
)   
;   
}!! 	
public## 
IActionResult## 
Privacy## $
(##$ %
)##% &
{$$ 	
return%% 
View%% 
(%% 
)%% 
;%% 
}&& 	
[(( 	
ResponseCache((	 
((( 
Duration(( 
=((  !
$num((" #
,((# $
Location((% -
=((. /!
ResponseCacheLocation((0 E
.((E F
None((F J
,((J K
NoStore((L S
=((T U
true((V Z
)((Z [
](([ \
public)) 
IActionResult)) 
Error)) "
())" #
)))# $
{** 	
return++ 
View++ 
(++ 
new++ 
ErrorViewModel++ *
{+++ ,
	RequestId++- 6
=++7 8
Activity++9 A
.++A B
Current++B I
?++I J
.++J K
Id++K M
??++N P
HttpContext++Q \
.++\ ]
TraceIdentifier++] l
}++m n
)++n o
;++o p
},, 	
}-- 
}.. ì¿
\D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Controllers\TrackingController.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Controllers. 9
{ 
public 

class 
TrackingController #
:$ %

Controller& 0
{ 
private 
readonly 
IClienteRepositorio ,
clienteRepositorio- ?
;? @
private 
readonly  
IEmpleadoRepositorio -
empleadoRepositorio. A
;A B
private 
readonly 
IPaqueteRepositorio ,
paqueteRepositorio- ?
;? @
private 
readonly &
IPaqueteClienteRepositorio 3%
paqueteClienteRepositorio4 M
;M N
private 
readonly '
IPaqueteEmpleadoRepositorio 4&
paqueteEmpleadoRepositorio5 O
;O P
public 
TrackingController !
(! "
IClienteRepositorio" 5
clienteRepositorio6 H
,H I 
IEmpleadoRepositorioJ ^
empleadoRepositorio_ r
,r s 
IPaqueteRepositorio	t á 
paqueteRepositorio
à ö
,
ö õ(
IPaqueteClienteRepositorio
ú ∂'
paqueteClienteRepositorio
∑ –
,
– —)
IPaqueteEmpleadoRepositorio
“ Ì(
paqueteEmpleadoRepositorio
Ó à
)
à â
{ 	
this 
. 
clienteRepositorio #
=$ %
clienteRepositorio& 8
;8 9
this 
. 
empleadoRepositorio $
=% &
empleadoRepositorio' :
;: ;
this 
. 
paqueteRepositorio #
=$ %
paqueteRepositorio& 8
;8 9
this 
. %
paqueteClienteRepositorio *
=+ ,%
paqueteClienteRepositorio- F
;F G
this 
. &
paqueteEmpleadoRepositorio +
=, -&
paqueteEmpleadoRepositorio. H
;H I
} 	
public!! 
IActionResult!! 
Index!! "
(!!" #
)!!# $
{"" 	
List## 
<## 
Paquete## 
>## 
paquetes## "
=### $
paqueteRepositorio##% 7
.##7 8
ObtenerTodos##8 D
(##D E
)##E F
;##F G
return%% 
View%% 
(%% 
paquetes%%  
)%%  !
;%%! "
}&& 	
[(( 	
HttpGet((	 
](( 
public)) 
IActionResult)) 
SearchTracking)) +
())+ ,
int)), /
	idPaquete))0 9
)))9 :
{** 	
var++ 
paqueteEmpleados++  
=++! "&
paqueteEmpleadoRepositorio++# =
.++= >
ObtenerPorIdPaquete++> Q
(++Q R
	idPaquete++R [
)++[ \
;++\ ]
ViewBag-- 
.-- 
Package-- 
=-- 
paqueteRepositorio-- 0
.--0 1
ObtenerPorId--1 =
(--= >
	idPaquete--> G
)--G H
;--H I
ViewBag.. 
... 
Actors.. 
=.. %
paqueteClienteRepositorio.. 6
...6 7
ObtenerActors..7 D
(..D E
	idPaquete..E N
)..N O
;..O P
if00 
(00 
ViewBag00 
.00 
Package00 
==00  "
null00# '
)00' (
{11 

ModelState22 
.22 
AddModelError22 (
(22( )
$str22) 4
,224 5
$str226 W
)22W X
;22X Y
return33 
View33 
(33 
$str33 #
)33# $
;33$ %
}44 
return55 
View55 
(55 
$str55 (
,55( )
paqueteEmpleados55* :
)55: ;
;55; <
}66 	
[88 	
	Authorize88	 
]88 
[99 	
HttpGet99	 
]99 
public:: 
IActionResult:: 
CreatePackage:: *
(::* +
)::+ ,
{;; 	
return== 
View== 
(== 
new== 
Paquete== #
(==# $
)==$ %
)==% &
;==& '
}>> 	
[?? 	
HttpPost??	 
]?? 
public@@ 
IActionResult@@ 
CreatePackage@@ *
(@@* +
Paquete@@+ 2
paquete@@3 :
)@@: ;
{AA 	
ifCC 
(CC 
paqueteCC 
.CC 
	ContenidoCC !
==CC" $
nullCC% )
||CC* ,
paqueteCC- 4
.CC4 5
	ContenidoCC5 >
==CC? A
$strCCB D
)CCD E
{DD 

ModelStateEE 
.EE 
AddModelErrorEE (
(EE( )
$strEE) 4
,EE4 5
$strEE6 S
)EES T
;EET U
}FF 
ifGG 
(GG 
paqueteGG 
.GG 
PesoGG 
==GG 
$numGG  !
||GG" $
paqueteGG% ,
.GG, -
PesoGG- 1
<GG2 3
$numGG4 5
)GG5 6
{HH 

ModelStateII 
.II 
AddModelErrorII (
(II( )
$strII) /
,II/ 0
$strII1 O
)IIO P
;IIP Q
}JJ 
ifKK 
(KK 
paqueteKK 
.KK 

DimensionXKK "
==KK# %
$numKK& '
||KK( *
paqueteKK+ 2
.KK2 3

DimensionXKK3 =
<KK> ?
$numKK@ A
)KKA B
{LL 

ModelStateMM 
.MM 
AddModelErrorMM (
(MM( )
$strMM) 5
,MM5 6
$strMM7 W
)MMW X
;MMX Y
}NN 
ifOO 
(OO 
paqueteOO 
.OO 

DimensionYOO "
==OO# %
$numOO& '
||OO( *
paqueteOO+ 2
.OO2 3

DimensionYOO3 =
<OO> ?
$numOO@ A
)OOA B
{PP 

ModelStateQQ 
.QQ 
AddModelErrorQQ (
(QQ( )
$strQQ) 5
,QQ5 6
$strQQ7 W
)QQW X
;QQX Y
}RR 
ifSS 
(SS 
paqueteSS 
.SS 

DimensionZSS "
==SS# %
$numSS& '
||SS( *
paqueteSS+ 2
.SS2 3

DimensionZSS3 =
<SS> ?
$numSS@ A
)SSA B
{TT 

ModelStateUU 
.UU 
AddModelErrorUU (
(UU( )
$strUU) 5
,UU5 6
$strUU7 W
)UUW X
;UUX Y
}VV 
ifWW 
(WW 
paqueteWW 
.WW 
CiudadOrigenWW $
==WW% '
paqueteWW( /
.WW/ 0

CiudadMetaWW0 :
)WW: ;
{XX 

ModelStateYY 
.YY 
AddModelErrorYY (
(YY( )
$strYY) 1
,YY1 2
$strYY3 h
)YYh i
;YYi j
}ZZ 
if[[ 
([[ 
paquete[[ 
.[[ 
PrecioEnvio[[ #
==[[$ &
$num[[' (
||[[) +
paquete[[, 3
.[[3 4

DimensionZ[[4 >
<[[? @
$num[[A B
)[[B C
{\\ 

ModelState]] 
.]] 
AddModelError]] (
(]]( )
$str]]) 1
,]]1 2
$str]]3 ]
)]]] ^
;]]^ _
}^^ 
ifaa 
(aa 
!aa 

ModelStateaa 
.aa 
IsValidaa #
)aa# $
{bb 

ModelStatecc 
.cc 
AddModelErrorcc (
(cc( )
$strcc) 1
,cc1 2
$strcc3 m
)ccm n
;ccn o
returnee 
Viewee 
(ee 
$stree +
,ee+ ,
paqueteee- 4
)ee4 5
;ee5 6
}ff 
paqueteRepositoriogg 
.gg 
Guardargg &
(gg& '
paquetegg' .
)gg. /
;gg/ 0
returnkk 
RedirectToActionkk #
(kk# $
$strkk$ 2
)kk2 3
;kk3 4
}ll 	
[nn 	
	Authorizenn	 
]nn 
[oo 	
HttpGetoo	 
]oo 
publicpp 
IActionResultpp 
CreateActorspp )
(pp) *
)pp* +
{qq 	
Paqueterr 
paqueterr 
=rr 
paqueteRepositoriorr 0
.rr0 1
ObtenerUltimorr1 >
(rr> ?
)rr? @
;rr@ A
ViewBagss 
.ss 
LastPackagess 
=ss  !
paquetess" )
.ss) *
	PaqueteIdss* 3
;ss3 4
Listtt 
<tt 
Clientett 
>tt 
Actorstt  
=tt! "
newtt# &
(tt& '
)tt' (
{uu 
newvv 
Clientevv 
{vv 
}vv 
,vv 
newww 
Clienteww 
{ww 
}ww 
}xx 
;xx 
returnzz 
Viewzz 
(zz 
Actorszz 
)zz 
;zz  
}{{ 	
[}} 	
HttpPost}}	 
]}} 
public~~ 
IActionResult~~ 
CreateActors~~ )
(~~) *
List~~* .
<~~. /
Cliente~~/ 6
>~~6 7
Actors~~8 >
)~~> ?
{ 	
Paquete
ÄÄ 
paquete
ÄÄ 
=
ÄÄ  
paqueteRepositorio
ÄÄ 0
.
ÄÄ0 1
ObtenerUltimo
ÄÄ1 >
(
ÄÄ> ?
)
ÄÄ? @
;
ÄÄ@ A
if
ÇÇ 
(
ÇÇ 
Actors
ÇÇ 
.
ÇÇ 
Count
ÇÇ 
==
ÇÇ 
$num
ÇÇ  !
)
ÇÇ! "
{
ÉÉ 

ModelState
ÑÑ 
.
ÑÑ 
AddModelError
ÑÑ (
(
ÑÑ( )
$str
ÑÑ) 0
,
ÑÑ0 1
$str
ÑÑ2 G
)
ÑÑG H
;
ÑÑH I
}
ÖÖ 
foreach
ÜÜ 
(
ÜÜ 
var
ÜÜ 
actor
ÜÜ 
in
ÜÜ !
Actors
ÜÜ" (
)
ÜÜ( )
{
áá 
if
àà 
(
àà 
actor
àà 
.
àà 
Nombre
àà  
==
àà! #
null
àà$ (
||
àà) +
actor
àà, 1
.
àà1 2
Nombre
àà2 8
==
àà9 ;
$str
àà< >
)
àà> ?
{
ââ 

ModelState
ää 
.
ää 
AddModelError
ää ,
(
ää, -
$str
ää- 5
,
ää5 6
$str
ää7 m
)
ääm n
;
ään o
}
ãã 
if
åå 
(
åå 
actor
åå 
.
åå 
Apellido
åå "
==
åå# %
null
åå& *
||
åå+ -
actor
åå. 3
.
åå3 4
Apellido
åå4 <
==
åå= ?
$str
åå@ B
)
ååB C
{
çç 

ModelState
éé 
.
éé 
AddModelError
éé ,
(
éé, -
$str
éé- 7
,
éé7 8
$str
éé9 q
)
ééq r
;
éér s
}
èè 
}
êê 
if
ëë 
(
ëë 
!
ëë 

ModelState
ëë 
.
ëë 
IsValid
ëë #
)
ëë# $
{
íí 
if
ìì 
(
ìì 
Actors
ìì 
[
ìì 
$num
ìì 
]
ìì 
.
ìì 
Dni
ìì !
!=
ìì" $
null
ìì% )
||
ìì* ,
Actors
ìì- 3
[
ìì3 4
$num
ìì4 5
]
ìì5 6
.
ìì6 7
Dni
ìì7 :
!=
ìì; =
null
ìì> B
)
ììB C
{
îî 
Actors
ïï 
=
ïï 
GetClientes
ïï (
(
ïï( )
Actors
ïï) /
)
ïï/ 0
;
ïï0 1
}
ññ 
ViewBag
óó 
.
óó 
LastPackage
óó #
=
óó$ %
paquete
óó& -
.
óó- .
	PaqueteId
óó. 7
;
óó7 8
return
òò 
View
òò 
(
òò 
$str
òò *
,
òò* +
Actors
òò, 2
)
òò2 3
;
òò3 4
}
ôô 
if
õõ 
(
õõ 
SearchCliente
õõ 
(
õõ 
Actors
õõ $
[
õõ$ %
$num
õõ% &
]
õõ& '
)
õõ' (
==
õõ( *
null
õõ* .
)
õõ. /
{
úú  
clienteRepositorio
ùù "
.
ùù" #
Guardar
ùù# *
(
ùù* +
Actors
ùù+ 1
[
ùù1 2
$num
ùù2 3
]
ùù3 4
)
ùù4 5
;
ùù5 6
}
ûû 
if
üü 
(
üü 
SearchCliente
üü 
(
üü 
Actors
üü $
[
üü$ %
$num
üü% &
]
üü& '
)
üü' (
==
üü) +
null
üü, 0
)
üü0 1
{
††  
clienteRepositorio
°° "
.
°°" #
Guardar
°°# *
(
°°* +
Actors
°°+ 1
[
°°1 2
$num
°°2 3
]
°°3 4
)
°°4 5
;
°°5 6
}
¢¢ 
PaqueteEmpleado
§§ 
	PeIngreso
§§ %
=
§§& '
new
§§( +
PaqueteEmpleado
§§, ;
{
§§< =
	IdPaquete
•• 
=
•• 
paquete
•• #
.
••# $
	PaqueteId
••$ -
,
••- .
Estado
¶¶ 
=
¶¶ 
$str
¶¶ %
,
¶¶% & 
FechaActualizacion
ßß "
=
ßß" #
DateTime
ßß$ ,
.
ßß, -
Now
ßß- 0
,
ßß0 1
CiudadActual
®® 
=
®® 
paquete
®® $
.
®®$ %
CiudadOrigen
®®% 1
,
®®1 2

IdEmpleado
©© 
=
©© 
GetLoggedUser
©© (
(
©©( )
)
©©) *
.
©©* +

EmpleadoId
©©+ 5
}
™™ 
;
™™ (
paqueteEmpleadoRepositorio
´´ &
.
´´& '
Guardar
´´' .
(
´´. /
	PeIngreso
´´/ 8
)
´´8 9
;
´´9 :
PaqueteCliente
ÆÆ 
PcEmisor
ÆÆ #
=
ÆÆ$ %
new
ÆÆ& )
PaqueteCliente
ÆÆ* 8
{
ÆÆ9 :
Rol
ÆÆ; >
=
ÆÆ> ?
$str
ÆÆ? G
,
ÆÆG H
	IdPaquete
ÆÆI R
=
ÆÆR S
paquete
ÆÆS Z
.
ÆÆZ [
	PaqueteId
ÆÆ[ d
,
ÆÆd e
	IdCliente
ÆÆe n
=
ÆÆo p!
clienteRepositorioÆÆq É
.ÆÆÉ Ñ
ObtenerPorDniÆÆÑ ë
(ÆÆë í
ActorsÆÆí ò
[ÆÆò ô
$numÆÆô ö
]ÆÆö õ
.ÆÆõ ú
DniÆÆú ü
)ÆÆü †
.ÆÆ† °
	ClienteIdÆÆ° ™
}ÆÆ™ ´
;ÆÆ´ ¨
PaqueteCliente
ØØ 

PcReceptor
ØØ %
=
ØØ& '
new
ØØ( +
PaqueteCliente
ØØ, :
{
ØØ; <
Rol
ØØ= @
=
ØØA B
$str
ØØC M
,
ØØM N
	IdPaquete
ØØO X
=
ØØY Z
paquete
ØØ[ b
.
ØØb c
	PaqueteId
ØØc l
,
ØØl m
	IdCliente
ØØn w
=
ØØx y!
clienteRepositorioØØz å
.ØØå ç
ObtenerPorDniØØç ö
(ØØö õ
ActorsØØõ °
[ØØ° ¢
$numØØ¢ £
]ØØ£ §
.ØØ§ •
DniØØ• ®
)ØØ® ©
.ØØ© ™
	ClienteIdØØ™ ≥
}ØØ¥ µ
;ØØµ ∂'
paqueteClienteRepositorio
±± %
.
±±% &
Guardar
±±& -
(
±±- .
PcEmisor
±±. 6
)
±±6 7
;
±±7 8'
paqueteClienteRepositorio
≤≤ %
.
≤≤% &
Guardar
≤≤& -
(
≤≤- .

PcReceptor
≤≤. 8
)
≤≤8 9
;
≤≤9 :
return
¥¥ 
View
¥¥ 
(
¥¥ 
$str
¥¥ 
)
¥¥  
;
¥¥  !
}
µµ 	
[
∑∑ 	
	Authorize
∑∑	 
]
∑∑ 
[
∏∏ 	
HttpGet
∏∏	 
]
∏∏ 
public
ππ 
IActionResult
ππ 
ViewPackages
ππ )
(
ππ) *
int
ππ* -
	IdPaquete
ππ. 7
)
ππ7 8
{
∫∫ 	
List
ªª 
<
ªª 
Paquete
ªª 
>
ªª 
paquetes
ªª "
=
ªª" #
null
ªª$ (
;
ªª( )
if
ºº 
(
ºº 
	IdPaquete
ºº 
==
ºº 
$num
ºº 
)
ºº 
{
ΩΩ 
paquetes
ææ 
=
ææ  
paqueteRepositorio
ææ -
.
ææ- .
ObtenerTodos
ææ. :
(
ææ: ;
)
ææ; <
;
ææ< =
}
øø 
else
¿¿ 
{
¡¡ 
paquetes
¬¬ 
=
¬¬  
paqueteRepositorio
¬¬ -
.
¬¬- .
ObtenerListaPorId
¬¬. ?
(
¬¬? @
	IdPaquete
¬¬@ I
)
¬¬I J
;
¬¬J K
}
√√ 
ViewBag
≈≈ 
.
≈≈ 
Aux
≈≈ 
=
≈≈ 
$num
≈≈ 
;
≈≈ 
return
∆∆ 
View
∆∆ 
(
∆∆ 
paquetes
∆∆  
)
∆∆  !
;
∆∆! "
}
«« 	
[
   	
	Authorize
  	 
]
   
[
ÀÀ 	
HttpGet
ÀÀ	 
]
ÀÀ 
public
ÃÃ 
IActionResult
ÃÃ 
UpdatePackage
ÃÃ *
(
ÃÃ* +
int
ÃÃ+ .
ID
ÃÃ/ 1
)
ÃÃ1 2
{
ÕÕ 	
ViewBag
ŒŒ 
.
ŒŒ 
	IdPackage
ŒŒ 
=
ŒŒ 
ID
ŒŒ  "
;
ŒŒ" #
ViewBag
œœ 
.
œœ 
Lista
œœ 
=
œœ (
paqueteEmpleadoRepositorio
œœ 6
.
œœ6 7!
ObtenerPorIdPaquete
œœ7 J
(
œœJ K
ID
œœK M
)
œœM N
;
œœN O
return
—— 
View
—— 
(
—— 
new
—— 
PaqueteEmpleado
—— +
(
——+ ,
)
——, -
)
——- .
;
——. /
}
““ 	
[
”” 	
HttpPost
””	 
]
”” 
public
‘‘ 
IActionResult
‘‘ 
UpdatePackage
‘‘ *
(
‘‘* +
PaqueteEmpleado
‘‘+ :
paqueteEmpleado
‘‘; J
)
‘‘J K
{
’’ 	
if
÷÷ 
(
÷÷ 
paqueteEmpleado
÷÷ 
.
÷÷  
Estado
÷÷  &
==
÷÷' )
null
÷÷* .
||
÷÷/ 1
paqueteEmpleado
÷÷2 A
.
÷÷A B
Estado
÷÷B H
==
÷÷I K
$str
÷÷L S
)
÷÷S T
{
◊◊ 

ModelState
ÿÿ 
.
ÿÿ 
AddModelError
ÿÿ (
(
ÿÿ( )
$str
ÿÿ) 0
,
ÿÿ0 1
$str
ÿÿ2 ]
)
ÿÿ] ^
;
ÿÿ^ _
}
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 
paqueteEmpleado
⁄⁄ 
.
⁄⁄  
CiudadActual
⁄⁄  ,
==
⁄⁄- /
null
⁄⁄0 4
||
⁄⁄5 7
paqueteEmpleado
⁄⁄8 G
.
⁄⁄G H
CiudadActual
⁄⁄H T
==
⁄⁄U W
$str
⁄⁄X _
)
⁄⁄_ `
{
€€ 

ModelState
‹‹ 
.
‹‹ 
AddModelError
‹‹ (
(
‹‹( )
$str
‹‹) 0
,
‹‹0 1
$str
‹‹2 ]
)
‹‹] ^
;
‹‹^ _
}
›› 
if
ﬁﬁ 
(
ﬁﬁ 
!
ﬁﬁ 

ModelState
ﬁﬁ 
.
ﬁﬁ 
IsValid
ﬁﬁ #
)
ﬁﬁ# $
{
ﬂﬂ 
ViewBag
‡‡ 
.
‡‡ 
	IdPackage
‡‡ !
=
‡‡" #
paqueteEmpleado
‡‡$ 3
.
‡‡3 4
	IdPaquete
‡‡4 =
;
‡‡= >
ViewBag
·· 
.
·· 
Lista
·· 
=
·· (
paqueteEmpleadoRepositorio
··  :
.
··: ;!
ObtenerPorIdPaquete
··; N
(
··N O
paqueteEmpleado
··O ^
.
··^ _
	IdPaquete
··_ h
)
··h i
;
··i j
return
‚‚ 
View
‚‚ 
(
‚‚ 
$str
‚‚ +
,
‚‚+ ,
paqueteEmpleado
‚‚- <
.
‚‚< =
	IdPaquete
‚‚= F
)
‚‚F G
;
‚‚G H
}
„„ 
paqueteEmpleado
‰‰ 
.
‰‰ 

IdEmpleado
‰‰ &
=
‰‰' (
GetLoggedUser
‰‰) 6
(
‰‰6 7
)
‰‰7 8
.
‰‰8 9

EmpleadoId
‰‰9 C
;
‰‰C D
paqueteEmpleado
ÂÂ 
.
ÂÂ  
FechaActualizacion
ÂÂ .
=
ÂÂ/ 0
DateTime
ÂÂ1 9
.
ÂÂ9 :
Now
ÂÂ: =
;
ÂÂ= >(
paqueteEmpleadoRepositorio
ÊÊ &
.
ÊÊ& '
Guardar
ÊÊ' .
(
ÊÊ. /
paqueteEmpleado
ÊÊ/ >
)
ÊÊ> ?
;
ÊÊ? @
return
ËË 
RedirectToAction
ËË #
(
ËË# $
$str
ËË$ 2
,
ËË2 3
$num
ËË3 4
)
ËË4 5
;
ËË5 6
}
ÈÈ 	
private
ÏÏ 
List
ÏÏ 
<
ÏÏ 
Cliente
ÏÏ 
>
ÏÏ 
GetClientes
ÏÏ )
(
ÏÏ) *
List
ÏÏ* .
<
ÏÏ. /
Cliente
ÏÏ/ 6
>
ÏÏ6 7
Actors
ÏÏ8 >
)
ÏÏ> ?
{
ÌÌ 	
Cliente
ÓÓ 
Emisor
ÓÓ 
=
ÓÓ 
Actors
ÓÓ #
[
ÓÓ# $
$num
ÓÓ$ %
]
ÓÓ% &
;
ÓÓ& '
Cliente
ÔÔ 
Receptor
ÔÔ 
=
ÔÔ 
Actors
ÔÔ %
[
ÔÔ% &
$num
ÔÔ& '
]
ÔÔ' (
;
ÔÔ( )
Emisor
 
=
 
SearchCliente
 "
(
" #
Emisor
# )
)
) *
;
* +
if
ÒÒ 
(
ÒÒ 
Emisor
ÒÒ 
!=
ÒÒ 
null
ÒÒ 
)
ÒÒ 
{
ÚÚ 
Actors
ÛÛ 
[
ÛÛ 
$num
ÛÛ 
]
ÛÛ 
=
ÛÛ 
Emisor
ÛÛ "
;
ÛÛ" #

ModelState
ÙÙ 
.
ÙÙ 
AddModelError
ÙÙ (
(
ÙÙ( )
$str
ÙÙ) 7
,
ÙÙ7 8
$str
ÙÙ9 T
)
ÙÙT U
;
ÙÙU V
}
ıı 
Receptor
ˆˆ 
=
ˆˆ 
SearchCliente
ˆˆ $
(
ˆˆ$ %
Receptor
ˆˆ% -
)
ˆˆ- .
;
ˆˆ. /
if
˜˜ 
(
˜˜ 
Receptor
˜˜ 
!=
˜˜ 
null
˜˜  
)
˜˜  !
{
¯¯ 
Actors
˘˘ 
[
˘˘ 
$num
˘˘ 
]
˘˘ 
=
˘˘ 
Receptor
˘˘ $
;
˘˘$ %

ModelState
˙˙ 
.
˙˙ 
AddModelError
˙˙ (
(
˙˙( )
$str
˙˙) 9
,
˙˙9 :
$str
˙˙; X
)
˙˙X Y
;
˙˙Y Z
}
˚˚ 
return
¸¸ 
Actors
¸¸ 
;
¸¸ 
}
˝˝ 	
private
ˇˇ 
Cliente
ˇˇ 
SearchCliente
ˇˇ %
(
ˇˇ% &
Cliente
ˇˇ& -
cliente
ˇˇ. 5
)
ˇˇ5 6
{
ÄÄ 	
Cliente
ÅÅ 
actor
ÅÅ 
=
ÅÅ  
clienteRepositorio
ÅÅ .
.
ÅÅ. /
ObtenerPorDni
ÅÅ/ <
(
ÅÅ< =
cliente
ÅÅ= D
.
ÅÅD E
Dni
ÅÅE H
)
ÅÅH I
;
ÅÅI J
if
ÉÉ 
(
ÉÉ 
actor
ÉÉ 
==
ÉÉ 
null
ÉÉ 
)
ÉÉ 
{
ÑÑ 
return
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
ÜÜ 
return
áá 
actor
áá 
;
áá 
}
àà 	
public
ää 
Empleado
ää 
GetLoggedUser
ää %
(
ää% &
)
ää& '
{
ãã 	
var
åå 
claim
åå 
=
åå 
HttpContext
åå #
.
åå# $
User
åå$ (
.
åå( )
Claims
åå) /
.
åå/ 0
FirstOrDefault
åå0 >
(
åå> ?
x
åå? @
=>
ååA C
x
ååD E
.
ååE F
Type
ååF J
==
ååK M

ClaimTypes
ååN X
.
ååX Y
Name
ååY ]
)
åå] ^
;
åå^ _
var
çç 
username
çç 
=
çç 
claim
çç  
.
çç  !
Value
çç! &
;
çç& '
return
éé !
empleadoRepositorio
éé &
.
éé& ' 
ObtenerPorUserName
éé' 9
(
éé9 :
username
éé: B
)
ééB C
;
ééC D
}
èè 	
}
êê 
}ëë ˙
KD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\DbEntities.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
{

 
public 

class 

DbEntities 
: 
	DbContext &
{ 
public 
virtual 
DbSet 
< 
Cliente $
>$ %
Clientes& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
Empleado %
>% &
	Empleados' 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
virtual 
DbSet 
< 
Paquete $
>$ %
Paquetes& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
PaqueteCliente +
>+ ,
PaqueteClientes- <
{= >
get? B
;B C
setD G
;G H
}I J
public 
virtual 
DbSet 
< 
PaqueteEmpleado ,
>, -
PaqueteEmpleados. >
{? @
getA D
;D E
setF I
;I J
}K L
public 
IEnumerable 
< 
object !
>! "
Paquete# *
{+ ,
get- 0
;0 1
internal2 :
set; >
;> ?
}@ A
public 

DbEntities 
( 
) 
{ 
} 
public 

DbEntities 
( 
DbContextOptions *
<* +

DbEntities+ 5
>5 6
options7 >
)> ?
:? @
baseA E
(E F
optionsF M
)M N
{O P
}Q R
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
ClienteMapping0 >
(> ?
)? @
)@ A
;A B
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
EmpleadoMapping0 ?
(? @
)@ A
)A B
;B C
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /!
PaqueteClienteMapping0 E
(E F
)F G
)G H
;H I
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /"
PaqueteEmpleadoMapping0 F
(F G
)G H
)H I
;I J
modelBuilder   
.   
ApplyConfiguration   +
(  + ,
new  , /
PaqueteMapping  0 >
(  > ?
)  ? @
)  @ A
;  A B
}!! 	
}## 
}$$ ¯
WD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\Mapping\ClienteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
ClienteMapping 
:  !$
IEntityTypeConfiguration" :
<: ;
Cliente; B
>B C
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Cliente0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
	ClienteId" +
)+ ,
;, -
} 	
} 
} ˝
XD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\Mapping\EmpleadoMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
EmpleadoMapping  
:! "$
IEntityTypeConfiguration# ;
<; <
Empleado< D
>D E
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Empleado0 8
>8 9
builder: A
)A B
{ 	
builder 
. 
ToTable 
( 
$str &
,& '
$str( -
)- .
;. /
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "

EmpleadoId" ,
), -
;- .
} 	
} 
} —
^D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\Mapping\PaqueteClienteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class !
PaqueteClienteMapping &
:' ($
IEntityTypeConfiguration) A
<A B
PaqueteClienteB P
>P Q
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
PaqueteCliente0 >
>> ?
builder@ G
)G H
{ 	
builder 
. 
ToTable 
( 
$str ,
,, -
$str. 3
)3 4
;4 5
builder 
. 
HasKey 
( 
o 
=> 
new  #
{$ %
o& '
.' (
	IdPaquete( 1
,1 2
o3 4
.4 5
	IdCliente5 >
}? @
)@ A
;A B
builder 
. 
HasOne 
< 
Cliente "
>" #
(# $
o$ %
=>& (
o) *
.* +
Client√´+ 2
)2 3
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdCliente& /
)/ 0
;0 1
} 	
} 
} °
_D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\Mapping\PaqueteEmpleadoMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class "
PaqueteEmpleadoMapping '
:( )$
IEntityTypeConfiguration* B
<B C
PaqueteEmpleadoC R
>R S
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
PaqueteEmpleado0 ?
>? @
builderA H
)H I
{ 	
builder 
. 
ToTable 
( 
$str -
,- .
$str/ 4
)4 5
;5 6
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
FechaActualizacion" 4
)4 5
;5 6
} 	
} 
} ¯
WD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\DB\Mapping\PaqueteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
PaqueteMapping 
:  !$
IEntityTypeConfiguration" :
<: ;
Paquete; B
>B C
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Paquete0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
	PaqueteId" +
)+ ,
;, -
} 	
} 
} ™
LD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\Cliente.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Cliente 
{		 
public

 
int

 
	ClienteId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Ruc 
{ 
get 
;  
set! $
;$ %
}& '
} 
} É
MD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\Empleado.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Empleado 
{		 
public

 
int

 

EmpleadoId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Usuario 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Clave 
{ 
get !
;! "
set# &
;& '
}( )
} 
} π
SD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\ErrorViewModel.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
ShowRequestId		 !
=>		" $
!		% &
string		& ,
.		, -
IsNullOrEmpty		- :
(		: ;
	RequestId		; D
)		D E
;		E F
}

 
}  
LD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\Paquete.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Paquete 
{		 
public

 
int

 
	PaqueteId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
double 
Peso 
{ 
get  
;  !
set" %
;% &
}' (
public 
double 

DimensionX  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 

DimensionY  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 

DimensionZ  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	Contenido 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
CiudadOrigen "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

CiudadMeta  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 
PrecioEnvio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
Pagado 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ±
SD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\PaqueteCliente.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
PaqueteCliente 
{		 
public

 
int

 
	IdPaquete

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Rol 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
	IdCliente 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Cliente 
? 
Client√´ 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} ”
TD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Models\PaqueteEmpleado.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
PaqueteEmpleado  
{		 
public

 
int

 

IdEmpleado

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
int 
	IdPaquete 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
FechaActualizacion *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
Estado 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CiudadActual "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ∑

ED:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Program.cs
	namespace

 	0
$TransportesYComercializaci√≥nTRANSMI


 -
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} ß
]D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Repositories\ClienteRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 
IClienteRepositorio

 (
{ 
void 
Guardar 
( 
Cliente 
cliente $
)$ %
;% &
List 
< 
Cliente 
> 
ObtenerTodos "
(" #
)# $
;$ %
Cliente 
ObtenerPorDni 
( 
string $
dni% (
)( )
;) *
} 
public 

class 
ClienteRepositorio #
:# $
IClienteRepositorio$ 7
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public 
ClienteRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Cliente #
cliente$ +
)+ ,
{ 	

dbEntities 
. 
Clientes 
.  
Add  #
(# $
cliente$ +
)+ ,
;, -

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
Cliente 
> 
ObtenerTodos )
() *
)* +
{ 	
return 

dbEntities 
. 
Clientes &
.& '
ToList' -
(- .
). /
;/ 0
} 	
public   
Cliente   
ObtenerPorDni   $
(  $ %
string  % +
dni  , /
)  / 0
{!! 	
return"" 

dbEntities"" 
."" 
Clientes"" &
.""& '
FirstOrDefault""' 5
(""5 6
o""6 7
=>""8 :
o""; <
.""< =
Dni""= @
==""A C
dni""D G
)""G H
;""H I
}## 	
}$$ 
}%% ì
^D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Repositories\EmpleadoRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

  
IEmpleadoRepositorio

 )
{ 
void 
Guardar 
( 
Empleado 
empleado &
)& '
;' (
List 
< 
Empleado 
> 
ObtenerTodos #
(# $
)$ %
;% &
Empleado 
ObtenerPorId 
( 
int !
id" $
)$ %
;% &
Empleado 
ObtenerPorUserName #
(# $
string$ *
username+ 3
)3 4
;4 5
} 
public 

class 
EmpleadoRepositorio $
:% & 
IEmpleadoRepositorio' ;
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public 
EmpleadoRepositorio "
(" #

DbEntities# -

dbEntities. 8
)8 9
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Empleado $
empleado% -
)- .
{ 	

dbEntities 
. 
	Empleados  
.  !
Add! $
($ %
empleado% -
)- .
;. /

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
Empleado 
ObtenerPorId $
($ %
int% (
id) +
)+ ,
{ 	
return   

dbEntities   
.   
	Empleados   '
.  ' (
FirstOrDefault  ( 6
(  6 7
o  7 8
=>  9 ;
o  < =
.  = >

EmpleadoId  > H
==  I K
id  L N
)  N O
;  O P
}!! 	
public## 
Empleado## 
ObtenerPorUserName## *
(##* +
string##+ 1
username##2 :
)##: ;
{$$ 	
return%% 

dbEntities%% 
.%% 
	Empleados%% '
.%%' (
FirstOrDefault%%( 6
(%%6 7
o%%7 8
=>%%9 ;
o%%< =
.%%= >
Usuario%%> E
==%%F H
username%%I Q
)%%Q R
;%%R S
}&& 	
public(( 
List(( 
<(( 
Empleado(( 
>(( 
ObtenerTodos(( *
(((* +
)((+ ,
{)) 	
return** 

dbEntities** 
.** 
	Empleados** '
.**' (
ToList**( .
(**. /
)**/ 0
;**0 1
}++ 	
},, 
}-- ≤"
dD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Repositories\PaqueteClienteRepositorio.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
Repositories		. :
{

 
public 

	interface &
IPaqueteClienteRepositorio /
{ 
void 
Guardar 
( 
PaqueteCliente #
paqueteCliente$ 2
)2 3
;3 4
List 
< 
PaqueteCliente 
> 
ObtenerTodos )
() *
)* +
;+ ,
List 
< 
PaqueteCliente 
> 
ObtenerActors *
(* +
int+ .
id/ 1
)1 2
;2 3
List 
< 
PaqueteCliente 
> 
ObtenerPorIdPaquete 0
(0 1
int1 4
id5 7
)7 8
;8 9
List 
< 
PaqueteCliente 
> 
ObtenerPorIdCliente 0
(0 1
int1 4
id5 7
)7 8
;8 9
} 
public 

class %
PaqueteClienteRepositorio *
:+ ,&
IPaqueteClienteRepositorio- G
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public %
PaqueteClienteRepositorio (
(( )

DbEntities) 3

dbEntities4 >
)> ?
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
PaqueteCliente *
paqueteCliente+ 9
)9 :
{ 	

dbEntities 
. 
PaqueteClientes &
.& '
Add' *
(* +
paqueteCliente+ 9
)9 :
;: ;

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public   
List   
<   
PaqueteCliente   "
>  " #
ObtenerPorIdPaquete  $ 7
(  7 8
int  8 ;
id  < >
)  > ?
{!! 	
return"" 

dbEntities"" 
."" 
PaqueteClientes"" -
.""- .
Where"". 3
(""3 4
o""4 5
=>""6 8
o""9 :
."": ;
	IdPaquete""; D
==""E G
id""H J
)""J K
.""K L
ToList""L R
(""R S
)""S T
;""T U
}## 	
public$$ 
List$$ 
<$$ 
PaqueteCliente$$ "
>$$" #
ObtenerPorIdCliente$$$ 7
($$7 8
int$$8 ;
id$$< >
)$$> ?
{%% 	
return&& 

dbEntities&& 
.&& 
PaqueteClientes&& -
.&&- .
Where&&. 3
(&&3 4
o&&4 5
=>&&6 8
o&&9 :
.&&: ;
	IdCliente&&; D
==&&E G
id&&H J
)&&J K
.&&K L
ToList&&L R
(&&R S
)&&S T
;&&T U
}'' 	
public)) 
List)) 
<)) 
PaqueteCliente)) "
>))" #
ObtenerTodos))$ 0
())0 1
)))1 2
{** 	
return++ 

dbEntities++ 
.++ 
PaqueteClientes++ -
.++- .
ToList++. 4
(++4 5
)++5 6
;++6 7
},, 	
public.. 
List.. 
<.. 
PaqueteCliente.. "
>.." #
ObtenerActors..$ 1
(..1 2
int..2 5
id..6 8
)..8 9
{// 	
return00 

dbEntities00 
.00 
PaqueteClientes00 -
.11 
Include11 
(11 
o11 
=>11 
o11 
.11  
Client√´11  '
)11' (
.22 
Where22 
(22 
o22 
=>22 
o22 
.22 
	IdPaquete22 '
==22( *
id22+ -
)22- .
.22. /
ToList22/ 5
(225 6
)226 7
;227 8
}33 	
}44 
}55 À
eD:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Repositories\PaqueteEmpleadoRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 '
IPaqueteEmpleadoRepositorio

 0
{ 
void 
Guardar 
( 
PaqueteEmpleado $
paqueteEmpleado% 4
)4 5
;5 6
List 
< 
PaqueteEmpleado 
> 
ObtenerTodos *
(* +
)+ ,
;, -
List 
< 
PaqueteEmpleado 
> 
ObtenerPorIdPaquete 1
(1 2
int2 5
id6 8
)8 9
;9 :
List 
< 
PaqueteEmpleado 
>  
ObtenerPorIdEmpleado 2
(2 3
int3 6
id7 9
)9 :
;: ;
} 
public 

class &
PaqueteEmpleadoRepositorio +
:, -'
IPaqueteEmpleadoRepositorio. I
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public &
PaqueteEmpleadoRepositorio )
() *

DbEntities* 4

dbEntities5 ?
)? @
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
PaqueteEmpleado +
paqueteEmpleado, ;
); <
{ 	

dbEntities 
. 
PaqueteEmpleados '
.' (
Add( +
(+ ,
paqueteEmpleado, ;
); <
;< =

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
PaqueteEmpleado #
># $
ObtenerPorIdPaquete% 8
(8 9
int9 <
id= ?
)? @
{ 	
return   

dbEntities   
.   
PaqueteEmpleados   .
.  . /
Where  / 4
(  4 5
o  5 6
=>  7 9
o  : ;
.  ; <
	IdPaquete  < E
==  F H
id  I K
)  K L
.  L M
ToList  M S
(  S T
)  T U
;  U V
}!! 	
public## 
List## 
<## 
PaqueteEmpleado## #
>### $ 
ObtenerPorIdEmpleado##% 9
(##9 :
int##: =
id##> @
)##@ A
{$$ 	
return%% 

dbEntities%% 
.%% 
PaqueteEmpleados%% .
.%%. /
Where%%/ 4
(%%4 5
o%%5 6
=>%%7 9
o%%: ;
.%%; <

IdEmpleado%%< F
==%%G I
id%%J L
)%%L M
.%%M N
ToList%%N T
(%%T U
)%%U V
;%%V W
}&& 	
public(( 
List(( 
<(( 
PaqueteEmpleado(( #
>((# $
ObtenerTodos((% 1
(((1 2
)((2 3
{)) 	
return** 

dbEntities** 
.** 
PaqueteEmpleados** .
.**. /
ToList**/ 5
(**5 6
)**6 7
;**7 8
}++ 	
},, 
}-- õ
]D:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Repositories\PaqueteRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 
IPaqueteRepositorio

 (
{ 
void 
Guardar 
( 
Paquete 
paquete $
)$ %
;% &
List 
< 
Paquete 
> 
ObtenerTodos "
(" #
)# $
;$ %
Paquete 
ObtenerPorId 
( 
int  
id! #
)# $
;$ %
List 
< 
Paquete 
> 
ObtenerListaPorId '
(' (
int( +
id, .
). /
;/ 0
Paquete 
ObtenerUltimo 
( 
) 
;  
} 
public 

class 
PaqueteRepositorio #
:$ %
IPaqueteRepositorio& 9
{ 
private 
readonly 

DbEntities #

dbEntities$ .
;. /
public 
PaqueteRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Paquete #
paquete$ +
)+ ,
{ 	

dbEntities 
. 
Paquetes 
.  
Add  #
(# $
paquete$ +
)+ ,
;, -

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
Paquete 
> 
ObtenerListaPorId .
(. /
int/ 2
id3 5
)5 6
{   	
return!! 

dbEntities!! 
.!! 
Paquetes!! &
.!!& '
Where!!' ,
(!!, -
o!!- .
=>!!/ 1
o!!2 3
.!!3 4
	PaqueteId!!4 =
==!!> @
id!!A C
)!!C D
.!!D E
ToList!!E K
(!!K L
)!!L M
;!!M N
}"" 	
public$$ 
Paquete$$ 
ObtenerPorId$$ #
($$# $
int$$$ '
id$$( *
)$$* +
{%% 	
return&& 

dbEntities&& 
.&& 
Paquetes&& &
.&&& '
FirstOrDefault&&' 5
(&&5 6
o&&6 7
=>&&8 :
o&&; <
.&&< =
	PaqueteId&&= F
==&&G I
id&&J L
)&&L M
;&&M N
}'' 	
public)) 
List)) 
<)) 
Paquete)) 
>)) 
ObtenerTodos)) )
())) *
)))* +
{** 	
return++ 

dbEntities++ 
.++ 
Paquetes++ &
.++& '
ToList++' -
(++- .
)++. /
;++/ 0
},, 	
public.. 
Paquete.. 
ObtenerUltimo.. $
(..$ %
)..% &
{// 	
return00 

dbEntities00 
.00 
Paquetes00 &
.00& '
OrderByDescending00' 8
(008 9
o009 :
=>00; =
o00> ?
.00? @
	PaqueteId00@ I
)00I J
.00J K
First00K P
(00P Q
)00Q R
;00R S
}11 	
}22 
}33 ®$
ED:\ProyectoFinalCalidad\ProyectoFinalDeCalidad\Transmi.Web\Startup.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. #
AddControllersWithViews ,
(, -
)- .
;. /
services   
.   
AddAuthentication   &
(  & '(
CookieAuthenticationDefaults  ' C
.  C D 
AuthenticationScheme  D X
)  X Y
.!! 
	AddCookie!! 
(!! 
options!! "
=>!!# %
{!!& '
options"" 
."" 
	LoginPath"" %
=""& '
$str""( 5
;""5 6
}$$ 
)$$ 
;$$ 
services'' 
.'' 
AddDbContext'' !
<''! "

DbEntities''" ,
>'', -
(''- .
options(( 
=>(( 
options(( "
.((" #
UseSqlServer((# /
(((/ 0
Configuration((0 =
.((= >
GetConnectionString((> Q
(((Q R
$str((R ]
)((] ^
)((^ _
))) 
;)) 
services-- 
.-- 
AddTransient-- !
<--! "
IClienteRepositorio--" 5
,--5 6
ClienteRepositorio--7 I
>--I J
(--J K
)--K L
;--L M
services.. 
... 
AddTransient.. !
<..! " 
IEmpleadoRepositorio.." 6
,..6 7
EmpleadoRepositorio..8 K
>..K L
(..L M
)..M N
;..N O
services// 
.// 
AddTransient// !
<//! "
IPaqueteRepositorio//" 5
,//5 6
PaqueteRepositorio//7 I
>//I J
(//J K
)//K L
;//L M
services00 
.00 
AddTransient00 !
<00! "&
IPaqueteClienteRepositorio00" <
,00< =%
PaqueteClienteRepositorio00> W
>00W X
(00X Y
)00Y Z
;00Z [
services11 
.11 
AddTransient11 !
<11! "'
IPaqueteEmpleadoRepositorio11" =
,11= >&
PaqueteEmpleadoRepositorio11? Y
>11Y Z
(11Z [
)11[ \
;11\ ]
}22 	
public55 
void55 
	Configure55 
(55 
IApplicationBuilder55 1
app552 5
,555 6
IWebHostEnvironment557 J
env55K N
)55N O
{66 	
if77 
(77 
env77 
.77 
IsDevelopment77 !
(77! "
)77" #
)77# $
{88 
app99 
.99 %
UseDeveloperExceptionPage99 -
(99- .
)99. /
;99/ 0
}:: 
else;; 
{<< 
app== 
.== 
UseExceptionHandler== '
(==' (
$str==( 5
)==5 6
;==6 7
app?? 
.?? 
UseHsts?? 
(?? 
)?? 
;?? 
}@@ 
appAA 
.AA 
UseHttpsRedirectionAA #
(AA# $
)AA$ %
;AA% &
appBB 
.BB 
UseStaticFilesBB 
(BB 
)BB  
;BB  !
appDD 
.DD 

UseRoutingDD 
(DD 
)DD 
;DD 
appFF 
.FF 
UseAuthenticationFF !
(FF! "
)FF" #
;FF# $
appGG 
.GG 
UseAuthorizationGG  
(GG  !
)GG! "
;GG" #
appII 
.II 
UseEndpointsII 
(II 
	endpointsII &
=>II' )
{JJ 
	endpointsKK 
.KK 
MapControllerRouteKK ,
(KK, -
nameLL 
:LL 
$strLL #
,LL# $
patternMM 
:MM 
$strMM E
)MME F
;MMF G
}NN 
)NN 
;NN 
}OO 	
}PP 
}QQ 