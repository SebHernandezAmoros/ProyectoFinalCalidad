Ω&
àD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Controllers\AuthController.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Controllers. 9
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 

DbEntities 

dbEntities %
;% &
public 
AuthController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Login "
(" #
string# )
Username* 2
,2 3
string4 :
Password; C
)C D
{ 	
if   
(   

dbEntities   
.   
	Empleados   #
.  # $
Any  $ '
(  ' (
o  ( )
=>  * ,
o  - .
.  . /
Usuario  / 6
==  7 9
Username  : B
&&  C E
o  F G
.  G H
Clave  H M
==  N P
Password  Q Y
)  Y Z
)  Z [
{!! 
var## 
claims## 
=## 
new##  
List##! %
<##% &
Claim##& +
>##+ ,
(##, -
)##- .
{$$ 
new%% 
Claim%% 
(%% 

ClaimTypes%% (
.%%( )
Name%%) -
,%%- .
Username%%/ 7
)%%7 8
,%%8 9
}&& 
;&& 
var'' 
claimsIdentity'' "
=''# $
new''% (
ClaimsIdentity'') 7
(''7 8
claims''8 >
,''> ?(
CookieAuthenticationDefaults''@ \
.''\ ] 
AuthenticationScheme''] q
)''q r
;''r s
var(( 
claimsPrincipal(( #
=(($ %
new((& )
ClaimsPrincipal((* 9
(((9 :
claimsIdentity((: H
)((H I
;((I J
HttpContext++ 
.++ 
SignInAsync++ '
(++' (
claimsPrincipal++( 7
)++7 8
;++8 9
return22 
RedirectToAction22 '
(22' (
$str22( .
,22. /
$str220 6
)226 7
;227 8
}33 

ModelState55 
.55 
AddModelError55 $
(55$ %
$str55% 0
,550 1
$str552 U
)55U V
;55V W
if66 
(66 
!66 

ModelState66 
.66 
IsValid66 #
)66# $
{77 
return88 
View88 
(88 
$str88 #
)88# $
;88$ %
}99 
return;; 
View;; 
(;; 
);; 
;;; 
}<< 	
[>> 	
HttpGet>>	 
]>> 
public?? 
IActionResult?? 
Logout?? #
(??# $
)??$ %
{@@ 	
HttpContextAA 
.AA 
SignOutAsyncAA $
(AA$ %
)AA% &
;AA& '
returnBB 
RedirectToActionBB #
(BB# $
$strBB$ +
)BB+ ,
;BB, -
}CC 	
[EE 	
HttpGetEE	 
]EE 
publicFF 
IActionResultFF 
InitFF !
(FF! "
)FF" #
{GG 	
ViewBagHH 
.HH 
perfilHH 
=HH 
GetLoggedUserHH *
(HH* +
)HH+ ,
;HH, -
returnJJ 
ViewJJ 
(JJ 
)JJ 
;JJ 
}KK 	
privateMM 
EmpleadoMM 
GetLoggedUserMM &
(MM& '
)MM' (
{NN 	
varOO 
claimOO 
=OO 
HttpContextOO #
.OO# $
UserOO$ (
.OO( )
ClaimsOO) /
.OO/ 0
FirstOrDefaultOO0 >
(OO> ?
)OO? @
;OO@ A
varPP 
usernamePP 
=PP 
claimPP  
.PP  !
ValuePP! &
;PP& '
returnQQ 

dbEntitiesQQ 
.QQ 
	EmpleadosQQ '
.QQ' (
FirstOrDefaultQQ( 6
(QQ6 7
oQQ7 8
=>QQ9 ;
oQQ< =
.QQ= >
UsuarioQQ> E
==QQF H
usernameQQI Q
)QQQ R
;QQR S
}RR 	
}SS 
}TT æ
àD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Controllers\HomeController.cs
	namespace

 	0
$TransportesYComercializaci√≥nTRANSMI


 -
.

- .
Controllers

. 9
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
ILogger  
<  !
HomeController! /
>/ 0
_logger1 8
;8 9
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
)< =
{ 	
_logger 
= 
logger 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
	Servicios &
(& '
)' (
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Nosotros %
(% &
)& '
{ 	
return 
View 
( 
) 
; 
}   	
public!! 
IActionResult!! 
Contactanos!! (
(!!( )
)!!) *
{"" 	
return## 
View## 
(## 
)## 
;## 
}$$ 	
public&& 
IActionResult&& 
Privacy&& $
(&&$ %
)&&% &
{'' 	
return(( 
View(( 
((( 
)(( 
;(( 
})) 	
[++ 	
ResponseCache++	 
(++ 
Duration++ 
=++  !
$num++" #
,++# $
Location++% -
=++. /!
ResponseCacheLocation++0 E
.++E F
None++F J
,++J K
NoStore++L S
=++T U
true++V Z
)++Z [
]++[ \
public,, 
IActionResult,, 
Error,, "
(,," #
),,# $
{-- 	
return.. 
View.. 
(.. 
new.. 
ErrorViewModel.. *
{..+ ,
	RequestId..- 6
=..7 8
Activity..9 A
...A B
Current..B I
?..I J
...J K
Id..K M
??..N P
HttpContext..Q \
...\ ]
TraceIdentifier..] l
}..m n
)..n o
;..o p
}// 	
}00 
}11 ·¬
åD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Controllers\TrackingController.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Controllers. 9
{ 
public 

class 
TrackingController #
:$ %

Controller& 0
{ 
private 

DbEntities 

dbEntities %
;% &
private 
readonly 
IClienteRepositorio ,
clienteRepositorio- ?
;? @
private 
readonly  
IEmpleadoRepositorio -
empleadoRepositorio. A
;A B
private 
readonly 
IPaqueteRepositorio ,
paqueteRepositorio- ?
;? @
private 
readonly &
IPaqueteClienteRepositorio 3%
paqueteClienteRepositorio4 M
;M N
private 
readonly '
IPaqueteEmpleadoRepositorio 4&
paqueteEmpleadoRepositorio5 O
;O P
public 
TrackingController !
(! "
IClienteRepositorio" 5
clienteRepositorio6 H
,H I 
IEmpleadoRepositorioJ ^
empleadoRepositorio_ r
,r s 
IPaqueteRepositorio	t á 
paqueteRepositorio
à ö
,
ö õ(
IPaqueteClienteRepositorio
ú ∂'
paqueteClienteRepositorio
∑ –
,
– —)
IPaqueteEmpleadoRepositorio
“ Ì(
paqueteEmpleadoRepositorio
Ó à
,
à â

DbEntities
ä î

dbEntities
ï ü
)
ü †
{ 	
this 
. 
clienteRepositorio #
=$ %
clienteRepositorio& 8
;8 9
this 
. 
empleadoRepositorio $
=% &
empleadoRepositorio' :
;: ;
this 
. 
paqueteRepositorio #
=$ %
paqueteRepositorio& 8
;8 9
this 
. %
paqueteClienteRepositorio *
=+ ,%
paqueteClienteRepositorio- F
;F G
this 
. &
paqueteEmpleadoRepositorio +
=, -&
paqueteEmpleadoRepositorio. H
;H I
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public!! 
IActionResult!! 
Index!! "
(!!" #
)!!# $
{"" 	
List## 
<## 
Paquete## 
>## 
paquetes## "
=### $
paqueteRepositorio##% 7
.##7 8
ObtenerTodos##8 D
(##D E
)##E F
;##F G
return&& 
View&& 
(&& 
paquetes&&  
)&&  !
;&&! "
}'' 	
[)) 	
HttpGet))	 
])) 
public** 
IActionResult** 
SearchTracking** +
(**+ ,
int**, /
	idPaquete**0 9
)**9 :
{++ 	
var,, 
paqueteEmpleados,,  
=,,! "&
paqueteEmpleadoRepositorio,,# =
.,,= >
ObtenerPorIdPaquete,,> Q
(,,Q R
	idPaquete,,R [
),,[ \
;,,\ ]
ViewBag// 
.// 
Package// 
=// 
paqueteRepositorio// 0
.//0 1
ObtenerPorId//1 =
(//= >
	idPaquete//> G
)//G H
;//H I
ViewBag00 
.00 
Actors00 
=00 %
paqueteClienteRepositorio00 6
.006 7
ObtenerActors007 D
(00D E
	idPaquete00E N
)00N O
;00O P
if55 
(55 
ViewBag55 
.55 
Package55 
==55  "
null55# '
)55' (
{66 

ModelState77 
.77 
AddModelError77 (
(77( )
$str77) 4
,774 5
$str776 W
)77W X
;77X Y
return88 
View88 
(88 
$str88 #
)88# $
;88$ %
}99 
return:: 
View:: 
(:: 
paqueteEmpleados:: (
)::( )
;::) *
};; 	
[== 	
	Authorize==	 
]== 
[>> 	
HttpGet>>	 
]>> 
public?? 
IActionResult?? 
CreatePackage?? *
(??* +
)??+ ,
{@@ 	
returnCC 
ViewCC 
(CC 
newCC 
PaqueteCC #
(CC# $
)CC$ %
)CC% &
;CC& '
}DD 	
[EE 	
HttpPostEE	 
]EE 
publicFF 
IActionResultFF 
CreatePackageFF *
(FF* +
PaqueteFF+ 2
paqueteFF3 :
)FF: ;
{GG 	
ifII 
(II 
paqueteII 
.II 
	ContenidoII !
==II" $
nullII% )
||II* ,
paqueteII- 4
.II4 5
	ContenidoII5 >
==II? A
$strIIB D
)IID E
{JJ 

ModelStateKK 
.KK 
AddModelErrorKK (
(KK( )
$strKK) 4
,KK4 5
$strKK6 S
)KKS T
;KKT U
}LL 
ifMM 
(MM 
paqueteMM 
.MM 
PesoMM 
==MM 
$numMM  !
||MM" $
paqueteMM% ,
.MM, -
PesoMM- 1
<MM2 3
$numMM4 5
)MM5 6
{NN 

ModelStateOO 
.OO 
AddModelErrorOO (
(OO( )
$strOO) /
,OO/ 0
$strOO1 O
)OOO P
;OOP Q
}PP 
ifQQ 
(QQ 
paqueteQQ 
.QQ 

DimensionXQQ "
==QQ# %
$numQQ& '
||QQ( *
paqueteQQ+ 2
.QQ2 3

DimensionXQQ3 =
<QQ> ?
$numQQ@ A
)QQA B
{RR 

ModelStateSS 
.SS 
AddModelErrorSS (
(SS( )
$strSS) 5
,SS5 6
$strSS7 W
)SSW X
;SSX Y
}TT 
ifUU 
(UU 
paqueteUU 
.UU 

DimensionYUU "
==UU# %
$numUU& '
||UU( *
paqueteUU+ 2
.UU2 3

DimensionYUU3 =
<UU> ?
$numUU@ A
)UUA B
{VV 

ModelStateWW 
.WW 
AddModelErrorWW (
(WW( )
$strWW) 5
,WW5 6
$strWW7 W
)WWW X
;WWX Y
}XX 
ifYY 
(YY 
paqueteYY 
.YY 

DimensionZYY "
==YY# %
$numYY& '
||YY( *
paqueteYY+ 2
.YY2 3

DimensionZYY3 =
<YY> ?
$numYY@ A
)YYA B
{ZZ 

ModelState[[ 
.[[ 
AddModelError[[ (
([[( )
$str[[) 5
,[[5 6
$str[[7 W
)[[W X
;[[X Y
}\\ 
if]] 
(]] 
paquete]] 
.]] 
CiudadOrigen]] $
==]]% '
paquete]]( /
.]]/ 0

CiudadMeta]]0 :
)]]: ;
{^^ 

ModelState__ 
.__ 
AddModelError__ (
(__( )
$str__) 1
,__1 2
$str__3 h
)__h i
;__i j
}`` 
ifaa 
(aa 
paqueteaa 
.aa 
PrecioEnvioaa #
==aa$ &
$numaa' (
||aa) +
paqueteaa, 3
.aa3 4

DimensionZaa4 >
<aa? @
$numaaA B
)aaB C
{bb 

ModelStatecc 
.cc 
AddModelErrorcc (
(cc( )
$strcc) 1
,cc1 2
$strcc3 ]
)cc] ^
;cc^ _
}dd 
ifgg 
(gg 
!gg 

ModelStategg 
.gg 
IsValidgg #
)gg# $
{hh 

ModelStateii 
.ii 
AddModelErrorii (
(ii( )
$strii) 1
,ii1 2
$strii3 m
)iim n
;iin o
returnkk 
Viewkk 
(kk 
$strkk +
,kk+ ,
paquetekk- 4
)kk4 5
;kk5 6
}ll 
paqueteRepositoriooo 
.oo 
Guardaroo &
(oo& '
paqueteoo' .
)oo. /
;oo/ 0
returnss 
RedirectToActionss #
(ss# $
$strss$ 2
)ss2 3
;ss3 4
}tt 	
[vv 	
	Authorizevv	 
]vv 
[ww 	
HttpGetww	 
]ww 
publicxx 
IActionResultxx 
CreateActorsxx )
(xx) *
)xx* +
{yy 	
Paquete{{ 
paquete{{ 
={{ 
paqueteRepositorio{{ 0
.{{0 1
ObtenerUltimo{{1 >
({{> ?
){{? @
;{{@ A
ViewBag|| 
.|| 
LastPackage|| 
=||  !
paquete||" )
.||) *
	PaqueteId||* 3
;||3 4
List}} 
<}} 
Cliente}} 
>}} 
Actors}}  
=}}! "
new}}# &
(}}& '
)}}' (
{~~ 
new 
Cliente 
{ 
} 
, 
new
ÄÄ 
Cliente
ÄÄ 
{
ÄÄ 
}
ÄÄ 
}
ÅÅ 
;
ÅÅ 
return
ÉÉ 
View
ÉÉ 
(
ÉÉ 
Actors
ÉÉ 
)
ÉÉ 
;
ÉÉ  
}
ÑÑ 	
[
ÜÜ 	
HttpPost
ÜÜ	 
]
ÜÜ 
public
áá 
IActionResult
áá 
CreateActors
áá )
(
áá) *
List
áá* .
<
áá. /
Cliente
áá/ 6
>
áá6 7
Actors
áá8 >
)
áá> ?
{
àà 	
Paquete
ää 
paquete
ää 
=
ää  
paqueteRepositorio
ää 0
.
ää0 1
ObtenerUltimo
ää1 >
(
ää> ?
)
ää? @
;
ää@ A
if
åå 
(
åå 
Actors
åå 
.
åå 
Count
åå 
==
åå 
$num
åå  !
)
åå! "
{
çç 

ModelState
éé 
.
éé 
AddModelError
éé (
(
éé( )
$str
éé) 0
,
éé0 1
$str
éé2 G
)
ééG H
;
ééH I
}
èè 
foreach
êê 
(
êê 
var
êê 
actor
êê 
in
êê !
Actors
êê" (
)
êê( )
{
ëë 
if
íí 
(
íí 
actor
íí 
.
íí 
Nombre
íí  
==
íí! #
null
íí$ (
||
íí) +
actor
íí, 1
.
íí1 2
Nombre
íí2 8
==
íí9 ;
$str
íí< >
)
íí> ?
{
ìì 

ModelState
îî 
.
îî 
AddModelError
îî ,
(
îî, -
$str
îî- 5
,
îî5 6
$str
îî7 m
)
îîm n
;
îîn o
}
ïï 
if
ññ 
(
ññ 
actor
ññ 
.
ññ 
Apellido
ññ "
==
ññ# %
null
ññ& *
||
ññ+ -
actor
ññ. 3
.
ññ3 4
Apellido
ññ4 <
==
ññ= ?
$str
ññ@ B
)
ññB C
{
óó 

ModelState
òò 
.
òò 
AddModelError
òò ,
(
òò, -
$str
òò- 7
,
òò7 8
$str
òò9 q
)
òòq r
;
òòr s
}
ôô 
}
öö 
if
õõ 
(
õõ 
!
õõ 

ModelState
õõ 
.
õõ 
IsValid
õõ #
)
õõ# $
{
úú 
if
ùù 
(
ùù 
Actors
ùù 
[
ùù 
$num
ùù 
]
ùù 
.
ùù 
Dni
ùù !
!=
ùù" $
null
ùù% )
||
ùù* ,
Actors
ùù- 3
[
ùù3 4
$num
ùù4 5
]
ùù5 6
.
ùù6 7
Dni
ùù7 :
!=
ùù; =
null
ùù> B
)
ùùB C
{
ûû 
Actors
üü 
=
üü 
GetClientes
üü (
(
üü( )
Actors
üü) /
)
üü/ 0
;
üü0 1
}
†† 
ViewBag
°° 
.
°° 
LastPackage
°° #
=
°°$ %
paquete
°°& -
.
°°- .
	PaqueteId
°°. 7
;
°°7 8
return
¢¢ 
View
¢¢ 
(
¢¢ 
$str
¢¢ *
,
¢¢* +
Actors
¢¢, 2
)
¢¢2 3
;
¢¢3 4
}
££ 
if
•• 
(
•• 
SearchCliente
•• 
(
•• 
Actors
•• $
[
••$ %
$num
••% &
]
••& '
)
••' (
==
••( *
null
••* .
)
••. /
{
¶¶  
clienteRepositorio
©© "
.
©©" #
Guardar
©©# *
(
©©* +
Actors
©©+ 1
[
©©1 2
$num
©©2 3
]
©©3 4
)
©©4 5
;
©©5 6
}
™™ 
if
´´ 
(
´´ 
SearchCliente
´´ 
(
´´ 
Actors
´´ $
[
´´$ %
$num
´´% &
]
´´& '
)
´´' (
==
´´) +
null
´´, 0
)
´´0 1
{
¨¨  
clienteRepositorio
ØØ "
.
ØØ" #
Guardar
ØØ# *
(
ØØ* +
Actors
ØØ+ 1
[
ØØ1 2
$num
ØØ2 3
]
ØØ3 4
)
ØØ4 5
;
ØØ5 6
}
∞∞ 
PaqueteEmpleado
≤≤ 
	PeIngreso
≤≤ %
=
≤≤& '
new
≤≤( +
PaqueteEmpleado
≤≤, ;
{
≤≤< =
	IdPaquete
≥≥ 
=
≥≥ 
paquete
≥≥ #
.
≥≥# $
	PaqueteId
≥≥$ -
,
≥≥- .
Estado
¥¥ 
=
¥¥ 
$str
¥¥ %
,
¥¥% & 
FechaActualizacion
µµ "
=
µµ" #
DateTime
µµ$ ,
.
µµ, -
Now
µµ- 0
,
µµ0 1
CiudadActual
∂∂ 
=
∂∂ 
paquete
∂∂ $
.
∂∂$ %
CiudadOrigen
∂∂% 1
,
∂∂1 2

IdEmpleado
∑∑ 
=
∑∑ 
GetLoggedUser
∑∑ (
(
∑∑( )
)
∑∑) *
.
∑∑* +

EmpleadoId
∑∑+ 5
}
∏∏ 
;
∏∏ (
paqueteEmpleadoRepositorio
ªª &
.
ªª& '
Guardar
ªª' .
(
ªª. /
	PeIngreso
ªª/ 8
)
ªª8 9
;
ªª9 :
PaqueteCliente
ææ 
PcEmisor
ææ #
=
ææ$ %
new
ææ& )
PaqueteCliente
ææ* 8
{
ææ9 :
Rol
ææ; >
=
ææ> ?
$str
ææ? G
,
ææG H
	IdPaquete
ææI R
=
ææR S
paquete
ææS Z
.
ææZ [
	PaqueteId
ææ[ d
,
ææd e
	IdCliente
ææe n
=
ææo p!
clienteRepositorioææq É
.ææÉ Ñ
ObtenerPorDniææÑ ë
(ææë í
Actorsææí ò
[ææò ô
$numææô ö
]ææö õ
.ææõ ú
Dniææú ü
)ææü †
.ææ† °
	ClienteIdææ° ™
}ææ™ ´
;ææ´ ¨
PaqueteCliente
øø 

PcReceptor
øø %
=
øø& '
new
øø( +
PaqueteCliente
øø, :
{
øø; <
Rol
øø= @
=
øøA B
$str
øøC M
,
øøM N
	IdPaquete
øøO X
=
øøY Z
paquete
øø[ b
.
øøb c
	PaqueteId
øøc l
,
øøl m
	IdCliente
øøn w
=
øøx y!
clienteRepositorioøøz å
.øøå ç
ObtenerPorDniøøç ö
(øøö õ
Actorsøøõ °
[øø° ¢
$numøø¢ £
]øø£ §
.øø§ •
Dniøø• ®
)øø® ©
.øø© ™
	ClienteIdøø™ ≥
}øø¥ µ
;øøµ ∂'
paqueteClienteRepositorio
√√ %
.
√√% &
Guardar
√√& -
(
√√- .
PcEmisor
√√. 6
)
√√6 7
;
√√7 8'
paqueteClienteRepositorio
ƒƒ %
.
ƒƒ% &
Guardar
ƒƒ& -
(
ƒƒ- .

PcReceptor
ƒƒ. 8
)
ƒƒ8 9
;
ƒƒ9 :
return
∆∆ 
View
∆∆ 
(
∆∆ 
$str
∆∆ 
)
∆∆  
;
∆∆  !
}
«« 	
[
…… 	
	Authorize
……	 
]
…… 
[
   	
HttpGet
  	 
]
   
public
ÀÀ 
IActionResult
ÀÀ 
ViewPackages
ÀÀ )
(
ÀÀ) *
int
ÀÀ* -
	IdPaquete
ÀÀ. 7
)
ÀÀ7 8
{
ÃÃ 	
List
ÕÕ 
<
ÕÕ 
Paquete
ÕÕ 
>
ÕÕ 
paquetes
ÕÕ "
=
ÕÕ" #
null
ÕÕ$ (
;
ÕÕ( )
if
ŒŒ 
(
ŒŒ 
	IdPaquete
ŒŒ 
==
ŒŒ 
$num
ŒŒ 
)
ŒŒ 
{
œœ 
paquetes
—— 
=
——  
paqueteRepositorio
—— -
.
——- .
ObtenerTodos
——. :
(
——: ;
)
——; <
;
——< =
}
““ 
else
”” 
{
‘‘ 
paquetes
÷÷ 
=
÷÷  
paqueteRepositorio
÷÷ -
.
÷÷- .
ObtenerListaPorId
÷÷. ?
(
÷÷? @
	IdPaquete
÷÷@ I
)
÷÷I J
;
÷÷J K
}
◊◊ 
ViewBag
ŸŸ 
.
ŸŸ 
Aux
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
;
ŸŸ 
return
⁄⁄ 
View
⁄⁄ 
(
⁄⁄ 
paquetes
⁄⁄  
)
⁄⁄  !
;
⁄⁄! "
}
€€ 	
[
ﬁﬁ 	
	Authorize
ﬁﬁ	 
]
ﬁﬁ 
[
ﬂﬂ 	
HttpGet
ﬂﬂ	 
]
ﬂﬂ 
public
‡‡ 
IActionResult
‡‡ 
UpdatePackage
‡‡ *
(
‡‡* +
int
‡‡+ .
ID
‡‡/ 1
)
‡‡1 2
{
·· 	
ViewBag
‚‚ 
.
‚‚ 
	IdPackage
‚‚ 
=
‚‚ 
ID
‚‚  "
;
‚‚" #
ViewBag
‰‰ 
.
‰‰ 
Lista
‰‰ 
=
‰‰ (
paqueteEmpleadoRepositorio
‰‰ 6
.
‰‰6 7!
ObtenerPorIdPaquete
‰‰7 J
(
‰‰J K
ID
‰‰K M
)
‰‰M N
;
‰‰N O
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
new
ÊÊ 
PaqueteEmpleado
ÊÊ +
(
ÊÊ+ ,
)
ÊÊ, -
)
ÊÊ- .
;
ÊÊ. /
}
ÁÁ 	
[
ËË 	
HttpPost
ËË	 
]
ËË 
public
ÈÈ 
IActionResult
ÈÈ 
UpdatePackage
ÈÈ *
(
ÈÈ* +
PaqueteEmpleado
ÈÈ+ :
paqueteEmpleado
ÈÈ; J
)
ÈÈJ K
{
ÍÍ 	
if
ÎÎ 
(
ÎÎ 
paqueteEmpleado
ÎÎ 
.
ÎÎ  
Estado
ÎÎ  &
==
ÎÎ' )
null
ÎÎ* .
||
ÎÎ/ 1
paqueteEmpleado
ÎÎ2 A
.
ÎÎA B
Estado
ÎÎB H
==
ÎÎI K
$str
ÎÎL S
)
ÎÎS T
{
ÏÏ 

ModelState
ÌÌ 
.
ÌÌ 
AddModelError
ÌÌ (
(
ÌÌ( )
$str
ÌÌ) 0
,
ÌÌ0 1
$str
ÌÌ2 ]
)
ÌÌ] ^
;
ÌÌ^ _
}
ÓÓ 
if
ÔÔ 
(
ÔÔ 
paqueteEmpleado
ÔÔ 
.
ÔÔ  
CiudadActual
ÔÔ  ,
==
ÔÔ- /
null
ÔÔ0 4
||
ÔÔ5 7
paqueteEmpleado
ÔÔ8 G
.
ÔÔG H
CiudadActual
ÔÔH T
==
ÔÔU W
$str
ÔÔX _
)
ÔÔ_ `
{
 

ModelState
ÒÒ 
.
ÒÒ 
AddModelError
ÒÒ (
(
ÒÒ( )
$str
ÒÒ) 0
,
ÒÒ0 1
$str
ÒÒ2 ]
)
ÒÒ] ^
;
ÒÒ^ _
}
ÚÚ 
if
ÛÛ 
(
ÛÛ 
!
ÛÛ 

ModelState
ÛÛ 
.
ÛÛ 
IsValid
ÛÛ #
)
ÛÛ# $
{
ÙÙ 
ViewBag
ıı 
.
ıı 
	IdPackage
ıı !
=
ıı" #
paqueteEmpleado
ıı$ 3
.
ıı3 4
	IdPaquete
ıı4 =
;
ıı= >
ViewBag
˜˜ 
.
˜˜ 
Lista
˜˜ 
=
˜˜ (
paqueteEmpleadoRepositorio
˜˜  :
.
˜˜: ;!
ObtenerPorIdPaquete
˜˜; N
(
˜˜N O
paqueteEmpleado
˜˜O ^
.
˜˜^ _
	IdPaquete
˜˜_ h
)
˜˜h i
;
˜˜i j
return
¯¯ 
View
¯¯ 
(
¯¯ 
$str
¯¯ +
,
¯¯+ ,
paqueteEmpleado
¯¯- <
.
¯¯< =
	IdPaquete
¯¯= F
)
¯¯F G
;
¯¯G H
}
˘˘ 
paqueteEmpleado
˙˙ 
.
˙˙ 

IdEmpleado
˙˙ &
=
˙˙' (
GetLoggedUser
˙˙) 6
(
˙˙6 7
)
˙˙7 8
.
˙˙8 9

EmpleadoId
˙˙9 C
;
˙˙C D
paqueteEmpleado
˚˚ 
.
˚˚  
FechaActualizacion
˚˚ .
=
˚˚/ 0
DateTime
˚˚1 9
.
˚˚9 :
Now
˚˚: =
;
˚˚= >(
paqueteEmpleadoRepositorio
˛˛ &
.
˛˛& '
Guardar
˛˛' .
(
˛˛. /
paqueteEmpleado
˛˛/ >
)
˛˛> ?
;
˛˛? @
return
ÄÄ 
RedirectToAction
ÄÄ #
(
ÄÄ# $
$str
ÄÄ$ 2
,
ÄÄ2 3
$num
ÄÄ3 4
)
ÄÄ4 5
;
ÄÄ5 6
}
ÅÅ 	
private
ÑÑ 
List
ÑÑ 
<
ÑÑ 
Cliente
ÑÑ 
>
ÑÑ 
GetClientes
ÑÑ )
(
ÑÑ) *
List
ÑÑ* .
<
ÑÑ. /
Cliente
ÑÑ/ 6
>
ÑÑ6 7
Actors
ÑÑ8 >
)
ÑÑ> ?
{
ÖÖ 	
Cliente
ÜÜ 
Emisor
ÜÜ 
=
ÜÜ 
Actors
ÜÜ #
[
ÜÜ# $
$num
ÜÜ$ %
]
ÜÜ% &
;
ÜÜ& '
Cliente
áá 
Receptor
áá 
=
áá 
Actors
áá %
[
áá% &
$num
áá& '
]
áá' (
;
áá( )
Emisor
àà 
=
àà 
SearchCliente
àà "
(
àà" #
Emisor
àà# )
)
àà) *
;
àà* +
if
ââ 
(
ââ 
Emisor
ââ 
!=
ââ 
null
ââ 
)
ââ 
{
ää 
Actors
ãã 
[
ãã 
$num
ãã 
]
ãã 
=
ãã 
Emisor
ãã "
;
ãã" #

ModelState
åå 
.
åå 
AddModelError
åå (
(
åå( )
$str
åå) 7
,
åå7 8
$str
åå9 T
)
ååT U
;
ååU V
}
çç 
Receptor
éé 
=
éé 
SearchCliente
éé $
(
éé$ %
Receptor
éé% -
)
éé- .
;
éé. /
if
èè 
(
èè 
Receptor
èè 
!=
èè 
null
èè  
)
èè  !
{
êê 
Actors
ëë 
[
ëë 
$num
ëë 
]
ëë 
=
ëë 
Receptor
ëë $
;
ëë$ %

ModelState
íí 
.
íí 
AddModelError
íí (
(
íí( )
$str
íí) 9
,
íí9 :
$str
íí; X
)
ííX Y
;
ííY Z
}
ìì 
return
îî 
Actors
îî 
;
îî 
}
ïï 	
private
óó 
Cliente
óó 
SearchCliente
óó %
(
óó% &
Cliente
óó& -
cliente
óó. 5
)
óó5 6
{
òò 	
Cliente
öö 
actor
öö 
=
öö  
clienteRepositorio
öö .
.
öö. /
ObtenerPorDni
öö/ <
(
öö< =
cliente
öö= D
.
ööD E
Dni
ööE H
)
ööH I
;
ööI J
if
úú 
(
úú 
actor
úú 
==
úú 
null
úú 
)
úú 
{
ùù 
return
ûû 
null
ûû 
;
ûû 
}
üü 
return
†† 
actor
†† 
;
†† 
}
°° 	
public
££ 
Empleado
££ 
GetLoggedUser
££ %
(
££% &
)
££& '
{
§§ 	
var
•• 
claim
•• 
=
•• 
HttpContext
•• #
.
••# $
User
••$ (
.
••( )
Claims
••) /
.
••/ 0
FirstOrDefault
••0 >
(
••> ?
x
••? @
=>
••A C
x
••D E
.
••E F
Type
••F J
==
••K M

ClaimTypes
••N X
.
••X Y
Name
••Y ]
)
••] ^
;
••^ _
var
¶¶ 
username
¶¶ 
=
¶¶ 
claim
¶¶  
.
¶¶  !
Value
¶¶! &
;
¶¶& '
return
ßß !
empleadoRepositorio
ßß &
.
ßß& ' 
ObtenerPorUserName
ßß' 9
(
ßß9 :
username
ßß: B
)
ßßB C
;
ßßC D
}
®® 	
}
©© 
}™™ ™
{D:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\DbEntities.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
{

 
public 

class 

DbEntities 
: 
	DbContext &
{ 
public 
virtual 
DbSet 
< 
Cliente $
>$ %
Clientes& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
Empleado %
>% &
	Empleados' 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
virtual 
DbSet 
< 
Paquete $
>$ %
Paquetes& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
PaqueteCliente +
>+ ,
PaqueteClientes- <
{= >
get? B
;B C
setD G
;G H
}I J
public 
virtual 
DbSet 
< 
PaqueteEmpleado ,
>, -
PaqueteEmpleados. >
{? @
getA D
;D E
setF I
;I J
}K L
public 
IEnumerable 
< 
object !
>! "
Paquete# *
{+ ,
get- 0
;0 1
internal2 :
set; >
;> ?
}@ A
public 

DbEntities 
( 
) 
{ 
} 
public 

DbEntities 
( 
DbContextOptions *
<* +

DbEntities+ 5
>5 6
options7 >
)> ?
:? @
baseA E
(E F
optionsF M
)M N
{O P
}Q R
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
ClienteMapping0 >
(> ?
)? @
)@ A
;A B
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
EmpleadoMapping0 ?
(? @
)@ A
)A B
;B C
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /!
PaqueteClienteMapping0 E
(E F
)F G
)G H
;H I
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /"
PaqueteEmpleadoMapping0 F
(F G
)G H
)H I
;I J
modelBuilder   
.   
ApplyConfiguration   +
(  + ,
new  , /
PaqueteMapping  0 >
(  > ?
)  ? @
)  @ A
;  A B
}!! 	
}## 
}$$ ©
áD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\Mapping\ClienteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
ClienteMapping 
:  !$
IEntityTypeConfiguration" :
<: ;
Cliente; B
>B C
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Cliente0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
	ClienteId" +
)+ ,
;, -
} 	
} 
} Æ
àD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\Mapping\EmpleadoMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
EmpleadoMapping  
:! "$
IEntityTypeConfiguration# ;
<; <
Empleado< D
>D E
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Empleado0 8
>8 9
builder: A
)A B
{ 	
builder 
. 
ToTable 
( 
$str &
,& '
$str( -
)- .
;. /
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "

EmpleadoId" ,
), -
;- .
} 	
} 
} Ç
éD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\Mapping\PaqueteClienteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class !
PaqueteClienteMapping &
:' ($
IEntityTypeConfiguration) A
<A B
PaqueteClienteB P
>P Q
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
PaqueteCliente0 >
>> ?
builder@ G
)G H
{ 	
builder 
. 
ToTable 
( 
$str ,
,, -
$str. 3
)3 4
;4 5
builder 
. 
HasKey 
( 
o 
=> 
new  #
{$ %
o& '
.' (
	IdPaquete( 1
,1 2
o3 4
.4 5
	IdCliente5 >
}? @
)@ A
;A B
builder 
. 
HasOne 
< 
Cliente "
>" #
(# $
o$ %
=>& (
o) *
.* +
Client√´+ 2
)2 3
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdCliente& /
)/ 0
;0 1
} 	
} 
} “
èD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\Mapping\PaqueteEmpleadoMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class "
PaqueteEmpleadoMapping '
:( )$
IEntityTypeConfiguration* B
<B C
PaqueteEmpleadoC R
>R S
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
PaqueteEmpleado0 ?
>? @
builderA H
)H I
{ 	
builder 
. 
ToTable 
( 
$str -
,- .
$str/ 4
)4 5
;5 6
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
FechaActualizacion" 4
)4 5
;5 6
} 	
} 
} ©
áD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\DB\Mapping\PaqueteMapping.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
DB		. 0
.		0 1
Mapping		1 8
{

 
public 

class 
PaqueteMapping 
:  !$
IEntityTypeConfiguration" :
<: ;
Paquete; B
>B C
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Paquete0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
	PaqueteId" +
)+ ,
;, -
} 	
} 
} ⁄
|D:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\Cliente.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Cliente 
{		 
public

 
int

 
	ClienteId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Ruc 
{ 
get 
;  
set! $
;$ %
}& '
} 
} ≥
}D:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\Empleado.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Empleado 
{		 
public

 
int

 

EmpleadoId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Usuario 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Clave 
{ 
get !
;! "
set# &
;& '
}( )
} 
} Í
ÉD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\ErrorViewModel.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
ShowRequestId		 !
=>		" $
!		% &
string		& ,
.		, -
IsNullOrEmpty		- :
(		: ;
	RequestId		; D
)		D E
;		E F
}

 
} ˙
|D:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\Paquete.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
Paquete 
{		 
public

 
int

 
	PaqueteId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
double 
Peso 
{ 
get  
;  !
set" %
;% &
}' (
public 
double 

DimensionX  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 

DimensionY  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 

DimensionZ  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	Contenido 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
CiudadOrigen "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

CiudadMeta  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 
PrecioEnvio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
Pagado 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ‚
ÉD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\PaqueteCliente.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
PaqueteCliente 
{		 
public

 
int

 
	IdPaquete

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Rol 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
	IdCliente 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Cliente 
? 
Client√´ 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} Ñ	
ÑD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Models\PaqueteEmpleado.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Models. 4
{ 
public 

class 
PaqueteEmpleado  
{		 
public

 
int

 

IdEmpleado

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
int 
	IdPaquete 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
FechaActualizacion *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
Estado 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CiudadActual "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} Á

uD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Program.cs
	namespace

 	0
$TransportesYComercializaci√≥nTRANSMI


 -
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} ¬
çD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Repositories\ClienteRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 
IClienteRepositorio

 (
{ 
void 
Guardar 
( 
Cliente 
cliente $
)$ %
;% &
List 
< 
Cliente 
> 
ObtenerTodos "
(" #
)# $
;$ %
Cliente 
ObtenerPorDni 
( 
string $
dni% (
)( )
;) *
} 
public 

class 
ClienteRepositorio #
:# $
IClienteRepositorio$ 7
{ 
private 

DbEntities 

dbEntities %
;% &
public 
ClienteRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Cliente #
cliente$ +
)+ ,
{ 	

dbEntities 
. 
Clientes 
.  
Add  #
(# $
cliente$ +
)+ ,
;, -

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
Cliente 
> 
ObtenerTodos )
() *
)* +
{ 	
return 

dbEntities 
. 
Clientes &
.& '
ToList' -
(- .
). /
;/ 0
} 	
public   
Cliente   
ObtenerPorDni   $
(  $ %
string  % +
dni  , /
)  / 0
{!! 	
return"" 

dbEntities"" 
."" 
Clientes"" &
.""& '
FirstOrDefault""' 5
(""5 6
o""6 7
=>""8 :
o""; <
.""< =
Dni""= @
==""A C
dni""D G
)""G H
;""H I
}## 	
}$$ 
}%% Æ
éD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Repositories\EmpleadoRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

  
IEmpleadoRepositorio

 )
{ 
void 
Guardar 
( 
Empleado 
empleado &
)& '
;' (
List 
< 
Empleado 
> 
ObtenerTodos #
(# $
)$ %
;% &
Empleado 
ObtenerPorId 
( 
int !
id" $
)$ %
;% &
Empleado 
ObtenerPorUserName #
(# $
string$ *
username+ 3
)3 4
;4 5
} 
public 

class 
EmpleadoRepositorio $
:% & 
IEmpleadoRepositorio' ;
{ 
private 

DbEntities 

dbEntities %
;% &
public 
EmpleadoRepositorio "
(" #

DbEntities# -

dbEntities. 8
)8 9
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Empleado $
empleado% -
)- .
{ 	

dbEntities 
. 
	Empleados  
.  !
Add! $
($ %
empleado% -
)- .
;. /

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
Empleado 
ObtenerPorId $
($ %
int% (
id) +
)+ ,
{ 	
return   

dbEntities   
.   
	Empleados   '
.  ' (
FirstOrDefault  ( 6
(  6 7
o  7 8
=>  9 ;
o  < =
.  = >

EmpleadoId  > H
==  I K
id  L N
)  N O
;  O P
}!! 	
public## 
Empleado## 
ObtenerPorUserName## *
(##* +
string##+ 1
username##2 :
)##: ;
{$$ 	
return%% 

dbEntities%% 
.%% 
	Empleados%% '
.%%' (
FirstOrDefault%%( 6
(%%6 7
o%%7 8
=>%%9 ;
o%%< =
.%%= >
Usuario%%> E
==%%F H
username%%I Q
)%%Q R
;%%R S
}&& 	
public(( 
List(( 
<(( 
Empleado(( 
>(( 
ObtenerTodos(( *
(((* +
)((+ ,
{)) 	
return** 

dbEntities** 
.** 
	Empleados** '
.**' (
ToList**( .
(**. /
)**/ 0
;**0 1
}++ 	
},, 
}-- Õ"
îD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Repositories\PaqueteClienteRepositorio.cs
	namespace		 	0
$TransportesYComercializaci√≥nTRANSMI		
 -
.		- .
Repositories		. :
{

 
public 

	interface &
IPaqueteClienteRepositorio /
{ 
void 
Guardar 
( 
PaqueteCliente #
paqueteCliente$ 2
)2 3
;3 4
List 
< 
PaqueteCliente 
> 
ObtenerTodos )
() *
)* +
;+ ,
List 
< 
PaqueteCliente 
> 
ObtenerActors *
(* +
int+ .
id/ 1
)1 2
;2 3
List 
< 
PaqueteCliente 
> 
ObtenerPorIdPaquete 0
(0 1
int1 4
id5 7
)7 8
;8 9
List 
< 
PaqueteCliente 
> 
ObtenerPorIdCliente 0
(0 1
int1 4
id5 7
)7 8
;8 9
} 
public 

class %
PaqueteClienteRepositorio *
:+ ,&
IPaqueteClienteRepositorio- G
{ 
private 

DbEntities 

dbEntities %
;% &
public %
PaqueteClienteRepositorio (
(( )

DbEntities) 3

dbEntities4 >
)> ?
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
PaqueteCliente *
paqueteCliente+ 9
)9 :
{ 	

dbEntities 
. 
PaqueteClientes &
.& '
Add' *
(* +
paqueteCliente+ 9
)9 :
;: ;

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public   
List   
<   
PaqueteCliente   "
>  " #
ObtenerPorIdPaquete  $ 7
(  7 8
int  8 ;
id  < >
)  > ?
{!! 	
return"" 

dbEntities"" 
."" 
PaqueteClientes"" -
.""- .
Where"". 3
(""3 4
o""4 5
=>""6 8
o""9 :
."": ;
	IdPaquete""; D
==""E G
id""H J
)""J K
.""K L
ToList""L R
(""R S
)""S T
;""T U
}## 	
public$$ 
List$$ 
<$$ 
PaqueteCliente$$ "
>$$" #
ObtenerPorIdCliente$$$ 7
($$7 8
int$$8 ;
id$$< >
)$$> ?
{%% 	
return&& 

dbEntities&& 
.&& 
PaqueteClientes&& -
.&&- .
Where&&. 3
(&&3 4
o&&4 5
=>&&6 8
o&&9 :
.&&: ;
	IdCliente&&; D
==&&E G
id&&H J
)&&J K
.&&K L
ToList&&L R
(&&R S
)&&S T
;&&T U
}'' 	
public)) 
List)) 
<)) 
PaqueteCliente)) "
>))" #
ObtenerTodos))$ 0
())0 1
)))1 2
{** 	
return++ 

dbEntities++ 
.++ 
PaqueteClientes++ -
.++- .
ToList++. 4
(++4 5
)++5 6
;++6 7
},, 	
public.. 
List.. 
<.. 
PaqueteCliente.. "
>.." #
ObtenerActors..$ 1
(..1 2
int..2 5
id..6 8
)..8 9
{// 	
return00 

dbEntities00 
.00 
PaqueteClientes00 -
.11 
Include11 
(11 
o11 
=>11 
o11 
.11  
Client√´11  '
)11' (
.22 
Where22 
(22 
o22 
=>22 
o22 
.22 
	IdPaquete22 '
==22( *
id22+ -
)22- .
.22. /
ToList22/ 5
(225 6
)226 7
;227 8
}33 	
}44 
}55 Ê
ïD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Repositories\PaqueteEmpleadoRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 '
IPaqueteEmpleadoRepositorio

 0
{ 
void 
Guardar 
( 
PaqueteEmpleado $
paqueteEmpleado% 4
)4 5
;5 6
List 
< 
PaqueteEmpleado 
> 
ObtenerTodos *
(* +
)+ ,
;, -
List 
< 
PaqueteEmpleado 
> 
ObtenerPorIdPaquete 1
(1 2
int2 5
id6 8
)8 9
;9 :
List 
< 
PaqueteEmpleado 
>  
ObtenerPorIdEmpleado 2
(2 3
int3 6
id7 9
)9 :
;: ;
} 
public 

class &
PaqueteEmpleadoRepositorio +
:, -'
IPaqueteEmpleadoRepositorio. I
{ 
private 

DbEntities 

dbEntities %
;% &
public &
PaqueteEmpleadoRepositorio )
() *

DbEntities* 4

dbEntities5 ?
)? @
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
PaqueteEmpleado +
paqueteEmpleado, ;
); <
{ 	

dbEntities 
. 
PaqueteEmpleados '
.' (
Add( +
(+ ,
paqueteEmpleado, ;
); <
;< =

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
PaqueteEmpleado #
># $
ObtenerPorIdPaquete% 8
(8 9
int9 <
id= ?
)? @
{ 	
return   

dbEntities   
.   
PaqueteEmpleados   .
.  . /
Where  / 4
(  4 5
o  5 6
=>  7 9
o  : ;
.  ; <
	IdPaquete  < E
==  F H
id  I K
)  K L
.  L M
ToList  M S
(  S T
)  T U
;  U V
}!! 	
public## 
List## 
<## 
PaqueteEmpleado## #
>### $ 
ObtenerPorIdEmpleado##% 9
(##9 :
int##: =
id##> @
)##@ A
{$$ 	
return%% 

dbEntities%% 
.%% 
PaqueteEmpleados%% .
.%%. /
Where%%/ 4
(%%4 5
o%%5 6
=>%%7 9
o%%: ;
.%%; <

IdEmpleado%%< F
==%%G I
id%%J L
)%%L M
.%%M N
ToList%%N T
(%%T U
)%%U V
;%%V W
}&& 	
public(( 
List(( 
<(( 
PaqueteEmpleado(( #
>((# $
ObtenerTodos((% 1
(((1 2
)((2 3
{)) 	
return** 

dbEntities** 
.** 
PaqueteEmpleados** .
.**. /
ToList**/ 5
(**5 6
)**6 7
;**7 8
}++ 	
},, 
}-- ∂
çD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Repositories\PaqueteRepositorio.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
.- .
Repositories. :
{		 
public

 

	interface

 
IPaqueteRepositorio

 (
{ 
void 
Guardar 
( 
Paquete 
paquete $
)$ %
;% &
List 
< 
Paquete 
> 
ObtenerTodos "
(" #
)# $
;$ %
Paquete 
ObtenerPorId 
( 
int  
id! #
)# $
;$ %
List 
< 
Paquete 
> 
ObtenerListaPorId '
(' (
int( +
id, .
). /
;/ 0
Paquete 
ObtenerUltimo 
( 
) 
;  
} 
public 

class 
PaqueteRepositorio #
:$ %
IPaqueteRepositorio& 9
{ 
private 

DbEntities 

dbEntities %
;% &
public 
PaqueteRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
this 
. 

dbEntities 
= 

dbEntities (
;( )
} 	
public 
void 
Guardar 
( 
Paquete #
paquete$ +
)+ ,
{ 	

dbEntities 
. 
Paquetes 
.  
Add  #
(# $
paquete$ +
)+ ,
;, -

dbEntities 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
public 
List 
< 
Paquete 
> 
ObtenerListaPorId .
(. /
int/ 2
id3 5
)5 6
{   	
return!! 

dbEntities!! 
.!! 
Paquetes!! &
.!!& '
Where!!' ,
(!!, -
o!!- .
=>!!/ 1
o!!2 3
.!!3 4
	PaqueteId!!4 =
==!!> @
id!!A C
)!!C D
.!!D E
ToList!!E K
(!!K L
)!!L M
;!!M N
}"" 	
public$$ 
Paquete$$ 
ObtenerPorId$$ #
($$# $
int$$$ '
id$$( *
)$$* +
{%% 	
return&& 

dbEntities&& 
.&& 
Paquetes&& &
.&&& '
FirstOrDefault&&' 5
(&&5 6
o&&6 7
=>&&8 :
o&&; <
.&&< =
	PaqueteId&&= F
==&&G I
id&&J L
)&&L M
;&&M N
}'' 	
public)) 
List)) 
<)) 
Paquete)) 
>)) 
ObtenerTodos)) )
())) *
)))* +
{** 	
return++ 

dbEntities++ 
.++ 
Paquetes++ &
.++& '
ToList++' -
(++- .
)++. /
;++/ 0
},, 	
public.. 
Paquete.. 
ObtenerUltimo.. $
(..$ %
)..% &
{// 	
return00 

dbEntities00 
.00 
Paquetes00 &
.00& '
OrderByDescending00' 8
(008 9
o009 :
=>00; =
o00> ?
.00? @
	PaqueteId00@ I
)00I J
.00J K
First00K P
(00P Q
)00Q R
;00R S
}11 	
}22 
}33 ÿ$
uD:\CICLOS\Ciclo 9\Calidad\ProyectoFinalCalidad\ProyectoFinalDeCalidad\TransportesYComercializaci√≥nTRANSMI\Startup.cs
	namespace 	0
$TransportesYComercializaci√≥nTRANSMI
 -
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. #
AddControllersWithViews ,
(, -
)- .
;. /
services   
.   
AddAuthentication   &
(  & '(
CookieAuthenticationDefaults  ' C
.  C D 
AuthenticationScheme  D X
)  X Y
.!! 
	AddCookie!! 
(!! 
options!! "
=>!!# %
{!!& '
options"" 
."" 
	LoginPath"" %
=""& '
$str""( 5
;""5 6
}$$ 
)$$ 
;$$ 
services'' 
.'' 
AddDbContext'' !
<''! "

DbEntities''" ,
>'', -
(''- .
options(( 
=>(( 
options(( "
.((" #
UseSqlServer((# /
(((/ 0
Configuration((0 =
.((= >
GetConnectionString((> Q
(((Q R
$str((R ]
)((] ^
)((^ _
))) 
;)) 
services-- 
.-- 
AddTransient-- !
<--! "
IClienteRepositorio--" 5
,--5 6
ClienteRepositorio--7 I
>--I J
(--J K
)--K L
;--L M
services.. 
... 
AddTransient.. !
<..! " 
IEmpleadoRepositorio.." 6
,..6 7
EmpleadoRepositorio..8 K
>..K L
(..L M
)..M N
;..N O
services// 
.// 
AddTransient// !
<//! "
IPaqueteRepositorio//" 5
,//5 6
PaqueteRepositorio//7 I
>//I J
(//J K
)//K L
;//L M
services00 
.00 
AddTransient00 !
<00! "&
IPaqueteClienteRepositorio00" <
,00< =%
PaqueteClienteRepositorio00> W
>00W X
(00X Y
)00Y Z
;00Z [
services11 
.11 
AddTransient11 !
<11! "'
IPaqueteEmpleadoRepositorio11" =
,11= >&
PaqueteEmpleadoRepositorio11? Y
>11Y Z
(11Z [
)11[ \
;11\ ]
}22 	
public55 
void55 
	Configure55 
(55 
IApplicationBuilder55 1
app552 5
,555 6
IWebHostEnvironment557 J
env55K N
)55N O
{66 	
if77 
(77 
env77 
.77 
IsDevelopment77 !
(77! "
)77" #
)77# $
{88 
app99 
.99 %
UseDeveloperExceptionPage99 -
(99- .
)99. /
;99/ 0
}:: 
else;; 
{<< 
app== 
.== 
UseExceptionHandler== '
(==' (
$str==( 5
)==5 6
;==6 7
app?? 
.?? 
UseHsts?? 
(?? 
)?? 
;?? 
}@@ 
appAA 
.AA 
UseHttpsRedirectionAA #
(AA# $
)AA$ %
;AA% &
appBB 
.BB 
UseStaticFilesBB 
(BB 
)BB  
;BB  !
appDD 
.DD 

UseRoutingDD 
(DD 
)DD 
;DD 
appFF 
.FF 
UseAuthenticationFF !
(FF! "
)FF" #
;FF# $
appGG 
.GG 
UseAuthorizationGG  
(GG  !
)GG! "
;GG" #
appII 
.II 
UseEndpointsII 
(II 
	endpointsII &
=>II' )
{JJ 
	endpointsKK 
.KK 
MapControllerRouteKK ,
(KK, -
nameLL 
:LL 
$strLL #
,LL# $
patternMM 
:MM 
$strMM E
)MME F
;MMF G
}NN 
)NN 
;NN 
}OO 	
}PP 
}QQ 